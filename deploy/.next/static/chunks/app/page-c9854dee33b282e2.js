(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{25435:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>M});var i=r(95155),a=r(12115),n=r(73321),s=r(26473);let l={ar:JSON.parse('{"app":{"name":"FormBridge AI","tagline":"مساعدك الذكي لتعبئة النماذج الألمانية"},"nav":{"home":"الرئيسية","credits":"الرصيد","language":"اللغة"},"hero":{"title":"عبّئ النماذج الألمانية بسهولة","subtitle":"ارفع صورة النموذج الألماني، أجب عن الأسئلة بالعربية، واحصل على النموذج معبأ بالألمانية"},"steps":{"upload":"رفع الصورة","answer":"الإجابة على الأسئلة","download":"تحميل النموذج"},"upload":{"title":"ارفع صورة النموذج","subtitle":"اسحب وأفلت الصورة هنا أو انقر للاختيار","formats":"الصيغ المدعومة: JPG, JPEG, PNG","maxSize":"الحجم الأقصى: 10 ميجابايت","remove":"إزالة الصورة","analyze":"تحليل النموذج","analyzing":"جارٍ التحليل..."},"questions":{"title":"أسئلة النموذج","subtitle":"يرجى الإجابة على الأسئلة التالية بالعربية","germanLabel":"السؤال بالألمانية:","placeholder":"اكتب إجابتك هنا...","submit":"إنشاء النموذج المعبأ","submitting":"جارٍ المعالجة...","requiredField":"هذا الحقل مطلوب"},"credits":{"remaining":"الرصيد المتبقي","cost":"تكلفة العملية","insufficient":"رصيد غير كافٍ","buy":"شراء رصيد","buyTitle":"شراء رصيد إضافي","buySubtitle":"اختر الباقة المناسبة لاحتياجاتك","mostPopular":"الأكثر شعبية","creditsLabel":"رصيد","perCredit":"للرصيد الواحد","buyNow":"اشترِ الآن","securePayment":"دفع آمن عبر Stripe","paymentSuccess":"تم الدفع بنجاح! تمت إضافة الرصيد إلى حسابك.","paymentCancelled":"تم إلغاء الدفع."},"errors":{"upload":"فشل في رفع الصورة. يرجى المحاولة مرة أخرى.","analyze":"فشل في تحليل النموذج. تأكد من أن الصورة واضحة.","submit":"فشل في معالجة النموذج. يرجى المحاولة مرة أخرى.","invalidFormat":"صيغة الملف غير مدعومة. استخدم JPG أو PNG.","fileTooLarge":"حجم الملف كبير جداً. الحد الأقصى 10 ميجابايت.","noQuestions":"لم يتم العثور على أسئلة في النموذج.","apiError":"حدث خطأ في الخادم. يرجى المحاولة لاحقاً."},"common":{"loading":"جارٍ التحميل...","retry":"إعادة المحاولة","cancel":"إلغاء","back":"رجوع","next":"التالي","close":"إغلاق"},"auth":{"loginTitle":"تسجيل الدخول","loginSubtitle":"أدخل بياناتك للوصول إلى حسابك","registerTitle":"إنشاء حساب جديد","registerSubtitle":"سجّل للحصول على 10 أرصدة مجانية","name":"الاسم","namePlaceholder":"أدخل اسمك","email":"البريد الإلكتروني","emailPlaceholder":"example@email.com","password":"كلمة المرور","passwordPlaceholder":"أدخل كلمة المرور","login":"تسجيل الدخول","register":"إنشاء الحساب","logout":"تسجيل الخروج","noAccount":"ليس لديك حساب؟","registerNow":"سجّل الآن","hasAccount":"لديك حساب بالفعل؟","loginNow":"سجّل دخولك","welcome":"مرحباً","requiredTitle":"سجّل دخولك للبدء","requiredSubtitle":"قم بإنشاء حساب مجاني أو سجّل دخولك لاستخدام FormBridge AI","feature1":"10 أرصدة مجانية عند التسجيل","feature2":"تحليل النماذج الألمانية بالذكاء الاصطناعي","feature3":"تصدير النتائج بصيغة PDF"},"result":{"title":"النموذج المعبأ","subtitle":"تم تعبئة النموذج بنجاح بالألمانية","download":"تحميل النتائج","downloadPDF":"تحميل PDF","downloadTXT":"تحميل نص","downloadFilledForm":"تحميل النموذج المعبأ","downloadFilledFormTooltip":"تحميل الصورة الأصلية مع الإجابات","copy":"نسخ الإجابات","copied":"تم النسخ!","newForm":"نموذج جديد","fieldLabel":"الحقل","generatingImage":"جارٍ إنشاء النموذج المعبأ..."}}'),de:JSON.parse('{"app":{"name":"FormBridge AI","tagline":"Ihr intelligenter Assistent f\xfcr deutsche Formulare"},"nav":{"home":"Startseite","credits":"Guthaben","language":"Sprache"},"hero":{"title":"Deutsche Formulare einfach ausf\xfcllen","subtitle":"Laden Sie ein Bild des deutschen Formulars hoch, beantworten Sie die Fragen auf Arabisch und erhalten Sie das Formular auf Deutsch ausgef\xfcllt"},"steps":{"upload":"Bild hochladen","answer":"Fragen beantworten","download":"Formular herunterladen"},"upload":{"title":"Formularbild hochladen","subtitle":"Ziehen Sie das Bild hierher oder klicken Sie zur Auswahl","formats":"Unterst\xfctzte Formate: JPG, JPEG, PNG","maxSize":"Maximale Gr\xf6\xdfe: 10 MB","remove":"Bild entfernen","analyze":"Formular analysieren","analyzing":"Analysiere..."},"questions":{"title":"Formularfragen","subtitle":"Bitte beantworten Sie die folgenden Fragen auf Arabisch","germanLabel":"Frage auf Deutsch:","placeholder":"Schreiben Sie hier Ihre Antwort...","submit":"Ausgef\xfclltes Formular erstellen","submitting":"Verarbeitung...","requiredField":"Dieses Feld ist erforderlich"},"result":{"title":"Ausgef\xfclltes Formular","subtitle":"Das Formular wurde erfolgreich auf Deutsch ausgef\xfcllt","download":"Ergebnisse herunterladen","downloadPDF":"PDF herunterladen","downloadTXT":"Text herunterladen","downloadFilledForm":"Ausgef\xfclltes Formular herunterladen","downloadFilledFormTooltip":"Originalbild mit Antworten herunterladen","copy":"Antworten kopieren","copied":"Kopiert!","newForm":"Neues Formular","fieldLabel":"Feld","generatingImage":"Ausgef\xfclltes Formular wird erstellt..."},"credits":{"remaining":"Verbleibendes Guthaben","cost":"Operationskosten","insufficient":"Unzureichendes Guthaben","buy":"Guthaben kaufen","buyTitle":"Zus\xe4tzliches Guthaben kaufen","buySubtitle":"W\xe4hlen Sie das passende Paket f\xfcr Ihre Bed\xfcrfnisse","mostPopular":"Beliebteste","creditsLabel":"Credits","perCredit":"pro Credit","buyNow":"Jetzt kaufen","securePayment":"Sichere Zahlung \xfcber Stripe","paymentSuccess":"Zahlung erfolgreich! Das Guthaben wurde Ihrem Konto gutgeschrieben.","paymentCancelled":"Zahlung abgebrochen."},"errors":{"upload":"Bild-Upload fehlgeschlagen. Bitte versuchen Sie es erneut.","analyze":"Formularanalyse fehlgeschlagen. Stellen Sie sicher, dass das Bild klar ist.","submit":"Formularverarbeitung fehlgeschlagen. Bitte versuchen Sie es erneut.","invalidFormat":"Dateiformat nicht unterst\xfctzt. Verwenden Sie JPG oder PNG.","fileTooLarge":"Datei zu gro\xdf. Maximum ist 10 MB.","noQuestions":"Keine Fragen im Formular gefunden.","apiError":"Serverfehler aufgetreten. Bitte versuchen Sie es sp\xe4ter."},"common":{"loading":"Laden...","retry":"Erneut versuchen","cancel":"Abbrechen","back":"Zur\xfcck","next":"Weiter","close":"Schlie\xdfen"},"auth":{"loginTitle":"Anmelden","loginSubtitle":"Geben Sie Ihre Daten ein, um auf Ihr Konto zuzugreifen","registerTitle":"Konto erstellen","registerSubtitle":"Registrieren Sie sich f\xfcr 10 kostenlose Credits","name":"Name","namePlaceholder":"Geben Sie Ihren Namen ein","email":"E-Mail","emailPlaceholder":"example@email.com","password":"Passwort","passwordPlaceholder":"Geben Sie Ihr Passwort ein","login":"Anmelden","register":"Registrieren","logout":"Abmelden","noAccount":"Noch kein Konto?","registerNow":"Jetzt registrieren","hasAccount":"Bereits ein Konto?","loginNow":"Jetzt anmelden","welcome":"Willkommen","requiredTitle":"Melden Sie sich an, um zu starten","requiredSubtitle":"Erstellen Sie ein kostenloses Konto oder melden Sie sich an, um FormBridge AI zu nutzen","feature1":"10 kostenlose Credits bei der Registrierung","feature2":"KI-Analyse von deutschen Formularen","feature3":"PDF-Export der Ergebnisse"}}')};function o(e,t){let r=t.split("."),i=l[e];for(let a of r)if(!i||"object"!=typeof i||!(a in i))return console.warn(`Translation missing: ${t} for locale ${e}`),t;else i=i[a];return"string"==typeof i?i:t}function d({locale:e,onLocaleChange:t,credits:r,user:n,onLoginClick:s,onLogout:l,onBuyCredits:d}){let[c,u]=(0,a.useState)(!1);return(0,i.jsx)("header",{className:"header",children:(0,i.jsxs)("div",{className:"container header__inner",children:[(0,i.jsxs)("a",{href:"/",className:"header__logo",children:[(0,i.jsx)("div",{className:"header__logo-icon",children:(0,i.jsx)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,i.jsx)("path",{d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),(0,i.jsx)("span",{children:"FormBridge AI"})]}),(0,i.jsxs)("nav",{className:"header__nav",children:[n&&(0,i.jsxs)("button",{className:"credit-badge",onClick:d,children:[(0,i.jsxs)("svg",{className:"credit-badge__icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,i.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,i.jsx)("path",{d:"M12 6v12M6 12h12"})]}),(0,i.jsx)("span",{className:"credit-badge__count",children:r}),(0,i.jsx)("span",{children:o(e,"credits.creditsLabel")})]}),(0,i.jsxs)("div",{className:"lang-switcher",children:[(0,i.jsx)("button",{className:`lang-switcher__btn ${"ar"===e?"active":""}`,onClick:()=>t("ar"),children:"العربية"}),(0,i.jsx)("button",{className:`lang-switcher__btn ${"de"===e?"active":""}`,onClick:()=>t("de"),children:"Deutsch"})]}),n?(0,i.jsxs)("div",{className:"user-menu",children:[(0,i.jsxs)("button",{className:"auth-btn",onClick:()=>u(!c),children:[(0,i.jsx)("span",{className:"auth-btn__avatar",children:n.name.charAt(0).toUpperCase()}),(0,i.jsx)("span",{children:n.name}),(0,i.jsx)("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,i.jsx)("path",{d:"M6 9l6 6 6-6"})})]}),c&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"user-menu__backdrop",onClick:()=>u(!1)}),(0,i.jsxs)("div",{className:"user-menu__dropdown",children:[(0,i.jsx)("div",{className:"user-menu__header",children:(0,i.jsx)("span",{className:"user-menu__email",children:n.email})}),(0,i.jsxs)("button",{className:"user-menu__item",onClick:()=>{d(),u(!1)},children:[(0,i.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,i.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,i.jsx)("path",{d:"M12 6v12M6 12h12"})]}),o(e,"credits.buy")]}),(0,i.jsxs)("button",{className:"user-menu__item user-menu__item--danger",onClick:()=>{l(),u(!1)},children:[(0,i.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,i.jsx)("path",{d:"M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4M16 17l5-5-5-5M21 12H9"})}),o(e,"auth.logout")]})]})]})]}):(0,i.jsx)("button",{className:"btn btn-primary",onClick:s,children:o(e,"auth.login")})]})]})})}var c=r(8703);function u({isOpen:e,onClose:t,onSuccess:r,locale:n}){let[s,l]=(0,a.useState)("login"),[d,u]=(0,a.useState)(!1),[m,h]=(0,a.useState)(null),[g,p]=(0,a.useState)(null),[x,f]=(0,a.useState)(""),[b,y]=(0,a.useState)(""),[j,v]=(0,a.useState)(""),[w,S]=(0,a.useState)(null);if((0,a.useEffect)(()=>{(async()=>{let e=await c.Ay.load(),{visitorId:t}=await e.get();S(t)})()},[]),!e)return null;let N=async e=>{e.preventDefault(),u(!0),h(null),p(null);try{let e="login"===s?{email:b,password:j}:{name:x,email:b,password:j,deviceId:w},i=await fetch("login"===s?"/api/auth/login":"/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),a=await i.json();if(!a.success)return void h(a.error||o(n,"errors.apiError"));if(a.requiresVerification)return void p(o(n,"auth.checkEmail")||"Please check your email to verify your account.");a.user&&(r(a.user),t())}catch{h(o(n,"errors.apiError"))}finally{u(!1)}};return(0,i.jsx)("div",{className:"modal-overlay",onClick:t,children:(0,i.jsxs)("div",{className:"modal-content glass-card animate-slide-up",onClick:e=>e.stopPropagation(),children:[(0,i.jsx)("button",{className:"modal-close",onClick:t,children:"✕"}),(0,i.jsx)("h2",{style:{marginBottom:"0.5rem"},children:"login"===s?o(n,"auth.loginTitle"):o(n,"auth.registerTitle")}),(0,i.jsx)("p",{style:{color:"var(--color-neutral-400)",marginBottom:"1.5rem"},children:"login"===s?o(n,"auth.loginSubtitle"):o(n,"auth.registerSubtitle")}),m&&(0,i.jsx)("div",{className:"alert alert-error",style:{marginBottom:"1rem"},children:m}),g?(0,i.jsxs)("div",{className:"alert alert-success",style:{marginBottom:"1rem",backgroundColor:"#dcfce7",color:"#166534",padding:"1rem",borderRadius:"0.5rem"},children:[g,(0,i.jsx)("p",{style:{marginTop:"0.5rem",fontSize:"0.9em"},children:"ar"===n?"يمكنك إغلاق هذه النافذة والتحقق من بريدك الإلكتروني.":"You can close this window and check your email."})]}):(0,i.jsxs)("form",{onSubmit:N,children:["register"===s&&(0,i.jsxs)("div",{className:"input-group",style:{marginBottom:"1rem"},children:[(0,i.jsx)("label",{className:"input-label",children:o(n,"auth.name")}),(0,i.jsx)("input",{type:"text",className:"input-field",value:x,onChange:e=>f(e.target.value),placeholder:o(n,"auth.namePlaceholder"),required:!0,dir:"auto"})]}),(0,i.jsxs)("div",{className:"input-group",style:{marginBottom:"1rem"},children:[(0,i.jsx)("label",{className:"input-label",children:o(n,"auth.email")}),(0,i.jsx)("input",{type:"email",className:"input-field",value:b,onChange:e=>y(e.target.value),placeholder:o(n,"auth.emailPlaceholder"),required:!0,dir:"ltr"})]}),(0,i.jsxs)("div",{className:"input-group",style:{marginBottom:"1.5rem"},children:[(0,i.jsx)("label",{className:"input-label",children:o(n,"auth.password")}),(0,i.jsx)("input",{type:"password",className:"input-field",value:j,onChange:e=>v(e.target.value),placeholder:o(n,"auth.passwordPlaceholder"),required:!0,minLength:6,dir:"ltr"})]}),(0,i.jsx)("button",{type:"submit",className:"btn btn-primary",style:{width:"100%"},disabled:d,children:d?o(n,"common.loading"):"login"===s?o(n,"auth.login"):o(n,"auth.register")})]}),(0,i.jsx)("div",{className:"modal-footer",children:"login"===s?(0,i.jsxs)("p",{children:[o(n,"auth.noAccount")," ",(0,i.jsx)("button",{className:"link-btn",onClick:()=>{l("register"),h(null),p(null)},children:o(n,"auth.registerNow")})]}):(0,i.jsxs)("p",{children:[o(n,"auth.hasAccount")," ",(0,i.jsx)("button",{className:"link-btn",onClick:()=>{l("login"),h(null),p(null)},children:o(n,"auth.loginNow")})]})})]})})}let m=[{id:"starter",name:"Starter",nameAr:"المبتدئ",credits:10,price:499,currency:"eur",popular:!1},{id:"popular",name:"Popular",nameAr:"الأكثر شعبية",credits:30,price:999,currency:"eur",popular:!0},{id:"pro",name:"Professional",nameAr:"المحترف",credits:100,price:2499,currency:"eur",popular:!1}];function h({isOpen:e,onClose:t,locale:r,isLoggedIn:n,onLoginRequired:s}){let[l,d]=(0,a.useState)("popular"),[c,u]=(0,a.useState)(!1),[h,g]=(0,a.useState)(null);if(!e)return null;let p=e=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(e/100),x=async()=>{if(!n)return void s();u(!0),g(null);try{let e=await fetch("/api/payments/checkout",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({packageId:l})}),t=await e.json();if(!t.success)return void g(t.error||o(r,"errors.apiError"));t.url&&(window.location.href=t.url)}catch{g(o(r,"errors.apiError"))}finally{u(!1)}};return(0,i.jsx)("div",{className:"modal-overlay",onClick:t,children:(0,i.jsxs)("div",{className:"modal-content glass-card animate-slide-up credits-modal",onClick:e=>e.stopPropagation(),children:[(0,i.jsx)("button",{className:"modal-close",onClick:t,children:"✕"}),(0,i.jsxs)("div",{className:"credits-modal__header",children:[(0,i.jsx)("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,i.jsx)("path",{d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,i.jsx)("h2",{children:o(r,"credits.buyTitle")}),(0,i.jsx)("p",{children:o(r,"credits.buySubtitle")})]}),h&&(0,i.jsx)("div",{className:"alert alert-error",style:{marginBottom:"1rem"},children:h}),(0,i.jsx)("div",{className:"credits-packages",children:m.map(e=>(0,i.jsxs)("div",{className:`credits-package ${l===e.id?"selected":""} ${e.popular?"popular":""}`,onClick:()=>d(e.id),children:[e.popular&&(0,i.jsx)("span",{className:"credits-package__badge",children:o(r,"credits.mostPopular")}),(0,i.jsx)("h3",{className:"credits-package__name",children:"ar"===r?e.nameAr:e.name}),(0,i.jsxs)("div",{className:"credits-package__credits",children:[(0,i.jsx)("span",{className:"credits-package__number",children:e.credits}),(0,i.jsx)("span",{className:"credits-package__label",children:o(r,"credits.creditsLabel")})]}),(0,i.jsx)("div",{className:"credits-package__price",children:p(e.price)}),(0,i.jsxs)("div",{className:"credits-package__per",children:[p(Math.round(e.price/e.credits))," / ",o(r,"credits.perCredit")]})]},e.id))}),(0,i.jsx)("button",{className:"btn btn-primary btn-lg",style:{width:"100%",marginTop:"1.5rem"},onClick:x,disabled:c,children:c?o(r,"common.loading"):o(r,"credits.buyNow")}),(0,i.jsxs)("p",{className:"credits-modal__secure",children:[(0,i.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,i.jsx)("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"})}),o(r,"credits.securePayment")]})]})})}let g=["upload","questions","result"];function p({currentStep:e,locale:t}){let r=g.indexOf(e);return(0,i.jsx)("div",{className:"steps-indicator",children:g.map((e,n)=>(0,i.jsxs)(a.Fragment,{children:[(0,i.jsxs)("div",{className:`step-item ${n===r?"active":""} ${n<r?"completed":""}`,children:[(0,i.jsx)("span",{className:"step-item__number",children:n<r?"✓":n+1}),(0,i.jsxs)("span",{className:"step-item__label",children:["upload"===e&&o(t,"steps.upload"),"questions"===e&&o(t,"steps.answer"),"result"===e&&o(t,"steps.download")]})]}),n<g.length-1&&(0,i.jsx)("div",{className:`step-connector ${n<r?"completed":""}`})]},e))})}let x=["image/jpeg","image/jpg","image/png"];function f(e){return x.includes(e.type.toLowerCase())?e.size>0xa00000?{valid:!1,error:"fileTooLarge"}:{valid:!0}:{valid:!1,error:"invalidFormat"}}function b({onImageSelected:e,onImageRemoved:t,currentImage:n,isLoading:s,locale:l,accept:d="image/jpeg,image/jpg,image/png"}){let[c,u]=(0,a.useState)(!1),[m,h]=(0,a.useState)(null),g=(0,a.useRef)(null),p=async t=>{h(null);try{if("application/pdf"===t.type){let i=await r.e(84).then(r.bind(r,66898));i.GlobalWorkerOptions.workerSrc=`https://cdnjs.cloudflare.com/ajax/libs/pdf.js/${i.version}/pdf.worker.min.mjs`;let a=await t.arrayBuffer(),n=await i.getDocument({data:a}).promise,s=await n.getPage(1),l=s.getViewport({scale:2}),o=document.createElement("canvas"),d=o.getContext("2d");if(!d)throw Error("Canvas context not available");o.width=l.width,o.height=l.height,await s.render({canvasContext:d,viewport:l}).promise;let c=o.toDataURL("image/png");e(t,c)}else{let r=f(t);if(!r.valid)return void h(o(l,`errors.${r.error}`));let i=await new Promise((e,r)=>{let i=new FileReader;i.onload=()=>e(i.result),i.onerror=()=>r(Error("Failed to read file")),i.readAsDataURL(t)});e(t,i)}}catch(e){console.error(e),h(o(l,"errors.upload"))}};return(0,i.jsxs)("div",{className:"glass-card animate-fade-in",children:[(0,i.jsxs)("div",{className:`upload-zone ${c?"dragging":""} ${n?"has-image":""}`,onDragOver:e=>{e.preventDefault(),u(!0)},onDragLeave:()=>u(!1),onDrop:e=>{e.preventDefault(),u(!1);let t=e.dataTransfer.files[0];t&&p(t)},onClick:()=>!n&&g.current?.click(),children:[(0,i.jsx)("input",{ref:g,type:"file",accept:d,onChange:e=>{let t=e.target.files?.[0];t&&p(t)},style:{display:"none"}}),n?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("img",{src:n,alt:"Preview",className:"upload-zone__preview"}),(0,i.jsx)("button",{className:"btn btn-secondary btn-icon upload-zone__remove",onClick:e=>{e.stopPropagation(),t()},disabled:s,children:"✕"})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("svg",{className:"upload-zone__icon",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),(0,i.jsxs)("div",{className:"upload-zone__text",children:[(0,i.jsx)("p",{className:"upload-zone__title",children:o(l,"upload.title")}),(0,i.jsx)("p",{className:"upload-zone__subtitle",children:o(l,"upload.subtitle")}),(0,i.jsx)("p",{className:"upload-zone__subtitle",children:d.includes("pdf")?o(l,"upload.formatsWithPdf"):o(l,"upload.formats")})]})]})]}),m&&(0,i.jsx)("div",{className:"alert alert-error",style:{marginTop:"1rem"},children:m})]})}function y({fields:e,onSubmit:t,isLoading:r,locale:n,imageBase64:s}){let[l,d]=(0,a.useState)({}),[c,u]=(0,a.useState)({});(0,a.useEffect)(()=>{let t={};e.forEach(e=>{e.prefilled&&e.existingValue&&(t[e.id]="")}),d(e=>({...e,...t}))},[e]);let m=(e,t)=>{d(r=>({...r,[e]:t})),c[e]&&u(t=>({...t,[e]:!1}))};return(0,i.jsxs)("form",{onSubmit:r=>{r.preventDefault();let i={};if(e.forEach(e=>{e.prefilled&&e.existingValue||e.required&&!l[e.id]?.trim()&&(i[e.id]=!0)}),Object.keys(i).length>0)return void u(i);let a={...l};e.forEach(e=>{e.prefilled&&e.existingValue&&!a[e.id]?.trim()&&(a[e.id]=e.existingValue)}),t(a)},className:"questions-container animate-slide-up",children:[(0,i.jsxs)("div",{className:"glass-card",children:[(0,i.jsx)("h2",{style:{marginBottom:"0.5rem"},children:o(n,"questions.title")}),(0,i.jsx)("p",{style:{marginBottom:"1.5rem",color:"var(--color-neutral-400)"},children:o(n,"questions.subtitle")})]}),e.map((e,t)=>(0,i.jsxs)("div",{className:"question-card",style:e.prefilled?{borderColor:"var(--color-success)",borderWidth:"2px"}:void 0,children:[(0,i.jsxs)("div",{className:"question-card__header",children:[(0,i.jsx)("span",{className:"question-card__number",children:t+1}),(0,i.jsxs)("div",{style:{flex:1},children:[(0,i.jsxs)("p",{className:"question-card__german",children:[o(n,"questions.germanLabel")," ",e.germanQuestion,e.prefilled&&(0,i.jsx)("span",{style:{marginRight:"0.5rem",marginLeft:"0.5rem",fontSize:"0.75rem",color:"var(--color-success)",background:"rgba(34, 197, 94, 0.1)",padding:"0.125rem 0.5rem",borderRadius:"0.25rem"},children:"ar"===n?"✓ معبأ مسبقاً":"✓ Bereits ausgef\xfcllt"})]}),(0,i.jsx)("p",{className:"question-card__arabic",children:e.arabicQuestion})]})]}),e.prefilled&&e.existingValue&&(0,i.jsxs)("div",{style:{background:"rgba(34, 197, 94, 0.1)",border:"1px solid var(--color-success)",borderRadius:"var(--radius-md)",padding:"var(--spacing-sm) var(--spacing-md)",marginBottom:"var(--spacing-sm)",fontSize:"0.875rem"},children:[(0,i.jsx)("span",{style:{color:"var(--color-neutral-400)",marginLeft:"0.5rem"},children:"ar"===n?"القيمة الحالية:":"Aktueller Wert:"}),(0,i.jsx)("span",{style:{color:"var(--color-success)",fontWeight:500},children:e.existingValue})]}),"textarea"===e.fieldType?(0,i.jsx)("textarea",{className:`input-field textarea-field ${c[e.id]?"error":""}`,value:l[e.id]||"",onChange:t=>m(e.id,t.target.value),placeholder:e.prefilled?"ar"===n?"اترك فارغاً لاستخدام القيمة الحالية":"Leer lassen f\xfcr aktuellen Wert":o(n,"questions.placeholder"),dir:"rtl"}):(0,i.jsx)("input",{type:"date"===e.fieldType?"date":"email"===e.fieldType?"email":"text",className:`input-field ${c[e.id]?"error":""}`,value:l[e.id]||"",onChange:t=>m(e.id,t.target.value),placeholder:e.prefilled?"ar"===n?"اترك فارغاً لاستخدام القيمة الحالية":"Leer lassen f\xfcr aktuellen Wert":o(n,"questions.placeholder"),dir:"rtl"}),c[e.id]&&(0,i.jsx)("p",{style:{color:"var(--color-error)",fontSize:"0.875rem",marginTop:"0.5rem"},children:o(n,"questions.requiredField")})]},e.id)),(0,i.jsx)("button",{type:"submit",className:"btn btn-primary btn-lg",disabled:r,style:{width:"100%"},children:r?o(n,"questions.submitting"):o(n,"questions.submit")}),s&&(0,i.jsxs)("div",{style:{marginTop:"2rem",textAlign:"center"},children:[(0,i.jsx)("h3",{style:{color:"var(--color-neutral-300)",marginBottom:"1rem"},children:"ar"===n?"نموذج الوثيقة (للمرجعية)":"Dokumentvorschau (Referenz)"}),(0,i.jsx)("img",{src:s,alt:"Form Reference",style:{maxWidth:"100%",borderRadius:"var(--radius-lg)",border:"1px solid var(--glass-border)"}})]})]})}var j=r(18831);async function v(e){let{imageBase64:t,fields:r,fontSize:i=14,fontColor:a="#000000",fontFamily:n="Arial, Helvetica, sans-serif",showBackground:s=!1,debugMode:l=!1,verticalOffset:o=0,horizontalOffset:d=0,skipPrefilled:c=!0}=e;return new Promise((e,u)=>{let m=new Image;m.crossOrigin="anonymous",m.onload=()=>{let t=document.createElement("canvas");t.width=m.width,t.height=m.height;let h=t.getContext("2d");if(!h)return void u(Error("Could not get canvas context"));h.drawImage(m,0,0);let g=Math.max(12,i*(Math.min(m.width,m.height)/900));r.forEach((e,t)=>{if(!e.position||!e.germanAnswer||c&&e.prefilled&&e.existingValue)return;let{x:r,y:i,width:u,height:p}=e.position,x=(r+d)/100*m.width,f=(i+o)/100*m.height,b=u/100*m.width,y=p/100*m.height;l&&(h.strokeStyle="rgba(255, 0, 0, 0.8)",h.lineWidth=2,h.strokeRect(x,f,b,y),h.fillStyle="rgba(255, 0, 0, 0.9)",h.font="bold 12px Arial",h.fillText(`#${t+1}`,x+2,f-4));let j=Math.max(10,Math.min(g,.8*y));h.font=`${j}px ${n}`,h.textBaseline="middle",h.textAlign="left",h.fillStyle=a;let v=m.width/1e3,w=5*v,S=x+w,N=Math.max(0,b-2*w);if(s&&(h.fillStyle="rgba(255, 255, 255, 0.9)",h.fillRect(x,f,b,y),h.fillStyle=a),h.measureText(e.germanAnswer).width>N){let t=e.germanAnswer.split(" "),r=[],i="";for(let e=0;e<t.length;e++){let a=i+t[e]+" ";h.measureText(a).width>N&&e>0?(r.push(i.trim()),i=t[e]+" "):i=a}r.push(i.trim());let a=1.2*j,n=r.length*a;h.textBaseline="top";let s=f+(y-n)/2;n>y&&(s=f+2*v),r.forEach(e=>{h.fillText(e,S,s),s+=a})}else h.fillText(e.germanAnswer,S,f+y/2)}),e(t.toDataURL("image/png",1))},m.onerror=()=>{u(Error("Failed to load image"))},m.src=t})}async function w(e,t){let i,a,{jsPDF:n}=await Promise.resolve().then(r.bind(r,18831)),s=new Image;s.src=e,await new Promise((e,t)=>{s.onload=()=>e(),s.onerror=()=>t(Error("Failed to load image"))});let l=s.width/s.height;l>1?a=(i=297)/l:i=(a=297)*l;let o=new n({orientation:l>1?"landscape":"portrait",unit:"mm",format:[i,a]});o.addImage(e,"PNG",0,0,i,a);let d=t||`ausgefuelltes_formular_${new Date().toISOString().split("T")[0]}.pdf`;o.save(d)}function S({result:e,onNewForm:t,locale:r,onAdjustPositions:n,imageBase64:s}){let[l,d]=(0,a.useState)(!1),[c,u]=(0,a.useState)(!1),[m,h]=(0,a.useState)(!1),[g,p]=(0,a.useState)(null),[x,f]=(0,a.useState)(!1),[b,y]=(0,a.useState)(!1),[S,N]=(0,a.useState)(!1);(0,a.useEffect)(()=>{m&&e.originalImage&&k()},[m,x,e]);let k=async()=>{if(e.originalImage){y(!0);try{let t=await v({imageBase64:e.originalImage,fields:e.fields.map(e=>({germanAnswer:e.germanAnswer,position:e.position,prefilled:e.prefilled,existingValue:e.existingValue})),fontSize:14,fontColor:"#0000AA",debugMode:x,showBackground:x,skipPrefilled:!x});p(t)}catch(e){console.error("Error generating preview:",e)}finally{y(!1)}}},C=async()=>{if(!e.originalImage)return void console.error("No original image available");u(!0);try{let t=await v({imageBase64:e.originalImage,fields:e.fields.map(e=>({germanAnswer:e.germanAnswer,position:e.position,prefilled:e.prefilled,existingValue:e.existingValue})),fontSize:14,fontColor:"#000000",debugMode:!1,skipPrefilled:!1,showBackground:!1});await w(t),N(!0)}catch(e){console.error("Error generating filled form:",e)}finally{u(!1)}},z=e.fields.some(e=>e.position),F=e.originalImage&&z;return S?(0,i.jsx)("div",{className:"animate-fade-in",style:{padding:"2rem"},children:(0,i.jsxs)("div",{className:"glass-card",style:{padding:"3rem",textAlign:"center",maxWidth:"500px",margin:"0 auto",display:"flex",flexDirection:"column",alignItems:"center",gap:"1.5rem"},children:[(0,i.jsx)("div",{style:{width:"64px",height:"64px",background:"rgba(34, 197, 94, 0.2)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",color:"#22c55e",fontSize:"32px"},children:"✓"}),(0,i.jsx)("h2",{style:{color:"white",margin:0},children:"ar"===r?"تمت العملية بنجاح":"Vorgang erfolgreich"}),(0,i.jsx)("p",{style:{color:"var(--color-neutral-300)",margin:0},children:"ar"===r?"تم تحميل النموذج الخاص بك بنجاح.":"Ihr Formular wurde erfolgreich heruntergeladen."}),(0,i.jsxs)("div",{style:{display:"flex",gap:"1rem",marginTop:"1rem",width:"100%"},children:[(0,i.jsx)("button",{onClick:t,className:"btn btn-primary",style:{flex:1},children:"ar"===r?"نموذج جديد":"Neues Formular"}),(0,i.jsx)("button",{onClick:()=>N(!1),className:"btn btn-secondary",style:{flex:1},children:"ar"===r?"عرض النتائج":"Ergebnisse anzeigen"})]})]})}):(0,i.jsxs)("div",{className:"result-preview animate-slide-up",children:[(0,i.jsxs)("div",{className:"result-preview__header",children:[(0,i.jsxs)("h2",{className:"result-preview__title",children:[(0,i.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),o(r,"result.title")]}),(0,i.jsx)("p",{style:{color:"var(--color-neutral-400)",fontSize:"0.875rem"},children:o(r,"result.subtitle")})]}),F&&(0,i.jsxs)("div",{className:"result-preview__visual",style:{marginBottom:"var(--spacing-lg)"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"var(--spacing-md)",flexWrap:"wrap",gap:"var(--spacing-sm)"},children:[(0,i.jsxs)("button",{className:"btn btn-secondary",onClick:()=>h(!m),style:{fontSize:"0.875rem"},children:[(0,i.jsxs)("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),m?"ar"===r?"إخفاء المعاينة":"Vorschau ausblenden":"ar"===r?"معاينة النتيجة":"Vorschau anzeigen"]}),m&&(0,i.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"var(--spacing-sm)",fontSize:"0.8125rem",color:"var(--color-neutral-400)",cursor:"pointer"},children:[(0,i.jsx)("input",{type:"checkbox",checked:x,onChange:e=>f(e.target.checked),style:{cursor:"pointer"}}),"ar"===r?"إظهار حدود الحقول":"Feldgrenzen anzeigen"]})]}),m&&(0,i.jsxs)("div",{style:{position:"relative",background:"rgba(0, 0, 0, 0.2)",borderRadius:"var(--radius-lg)",padding:"var(--spacing-md)",overflow:"auto",maxHeight:"500px"},children:[b?(0,i.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"200px"},children:(0,i.jsx)("div",{className:"loading-spinner"})}):g?(0,i.jsx)("img",{src:g,alt:"Preview",style:{maxWidth:"100%",height:"auto",borderRadius:"var(--radius-md)",boxShadow:"var(--shadow-lg)"}}):null,x&&g&&(0,i.jsx)("p",{style:{marginTop:"var(--spacing-sm)",fontSize:"0.75rem",color:"var(--color-neutral-500)",textAlign:"center"},children:"ar"===r?"المستطيلات الحمراء تُظهر مواقع الحقول المكتشفة. النص الأزرق يُظهر إجاباتك.":"Rote Rechtecke zeigen erkannte Feldpositionen. Blauer Text zeigt Ihre Antworten."})]})]}),(0,i.jsx)("div",{className:"result-preview__fields",children:e.fields.map((e,t)=>(0,i.jsxs)("div",{className:"result-field",title:e.position?`Position: x=${e.position.x.toFixed(1)}%, y=${e.position.y.toFixed(1)}%, w=${e.position.width.toFixed(1)}%, h=${e.position.height.toFixed(1)}%`:"No position data",children:[(0,i.jsxs)("span",{className:"result-field__label",children:[(0,i.jsxs)("span",{style:{fontSize:"0.625rem",color:"var(--color-neutral-500)",marginRight:"var(--spacing-xs)"},children:["#",t+1]}),e.germanQuestion]}),(0,i.jsx)("span",{className:"result-field__value",children:e.germanAnswer}),e.position&&(0,i.jsxs)("span",{style:{fontSize:"0.625rem",color:"var(--color-neutral-600)",marginTop:"var(--spacing-xs)"},children:["\uD83D\uDCCD x:",e.position.x.toFixed(0),"% y:",e.position.y.toFixed(0),"% | ",e.position.width.toFixed(0),"\xd7",e.position.height.toFixed(0),"%"]})]},t))}),(0,i.jsxs)("div",{className:"result-actions",children:[(0,i.jsxs)("div",{className:"result-actions__download",children:[F&&(0,i.jsx)("button",{className:"btn btn-primary btn-filled-form",onClick:C,disabled:c,title:o(r,"result.downloadFilledFormTooltip"),children:c?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{className:"loading-spinner",style:{width:18,height:18}}),o(r,"result.generatingImage")]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("svg",{width:"18",height:"18",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),o(r,"result.downloadFilledForm")]})}),(0,i.jsxs)("button",{className:"btn btn-primary",onClick:()=>{!function(e){let{title:t="Ausgef\xfclltes Formular",subtitle:r,fields:i,generatedAt:a}=e,n=new j.jsPDF({orientation:"portrait",unit:"mm",format:"a4"}),s=n.internal.pageSize.getWidth(),l=s-40,o=20;n.setFillColor(15,23,42),n.rect(0,0,s,40,"F"),n.setTextColor(255,255,255),n.setFontSize(20),n.setFont("helvetica","bold"),n.text("FormBridge AI",20,18),n.setFontSize(10),n.setFont("helvetica","normal"),n.text(t,20,28),r&&n.text(r,20,35),o=55,n.setTextColor(100,116,139),n.setFontSize(9);let d=new Date(a).toLocaleDateString("de-DE",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});n.text(`Erstellt am: ${d}`,20,o),o+=15,n.setTextColor(30,41,59),i.forEach((e,t)=>{o>260&&(n.addPage(),o=20),n.setFillColor(0,98,230),n.circle(24,o,4,"F"),n.setTextColor(255,255,255),n.setFontSize(8),n.text(String(t+1),22.5,o+1.5),n.setTextColor(100,116,139),n.setFontSize(9),n.setFont("helvetica","normal"),n.text(e.germanQuestion,32,o),o+=6,n.setTextColor(30,41,59),n.setFontSize(11),n.setFont("helvetica","bold");let r=n.splitTextToSize(e.germanAnswer||"—",l-12);n.text(r,32,o),o+=5*r.length+8,n.setDrawColor(226,232,240),n.setLineWidth(.2),n.line(20,o,s-20,o),o+=8});let c=n.internal.pageSize.getHeight()-15;n.setTextColor(148,163,184),n.setFontSize(8),n.setFont("helvetica","normal"),n.text("Generiert mit FormBridge AI - Ihr intelligenter Formular-Assistent",20,c),n.text("Seite 1",s-20-15,c);let u=`formular_${new Date().toISOString().split("T")[0]}.pdf`;n.save(u)}({title:"Ausgef\xfclltes Formular",subtitle:"Generiert mit FormBridge AI",fields:e.fields,generatedAt:e.generatedAt}),setTimeout(()=>N(!0),1500)},children:[(0,i.jsx)("svg",{width:"18",height:"18",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),o(r,"result.downloadPDF")]}),(0,i.jsx)("button",{className:"btn btn-secondary",onClick:()=>{let t,r,i;t=new Blob([e.fields.map((e,t)=>`${t+1}. ${e.germanQuestion}
   Antwort: ${e.germanAnswer}`).join("\n\n")],{type:"text/plain;charset=utf-8"}),r=URL.createObjectURL(t),(i=document.createElement("a")).href=r,i.download=`formular_${new Date().toISOString().split("T")[0]}.txt`,i.click(),URL.revokeObjectURL(r),setTimeout(()=>N(!0),1500)},children:o(r,"result.downloadTXT")})]}),(0,i.jsxs)("div",{className:"result-actions__other",children:[n&&s&&z&&(0,i.jsxs)("button",{className:"btn btn-secondary",onClick:n,style:{display:"flex",alignItems:"center",gap:"var(--spacing-xs)",borderColor:"var(--color-warning)",color:"var(--color-warning)"},children:[(0,i.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,i.jsx)("path",{d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"ar"===r?"تعديل مواقع الحقول":"Positionen anpassen"]}),(0,i.jsx)("button",{className:"btn btn-secondary",onClick:()=>{let t=e.fields.map(e=>`${e.germanQuestion}: ${e.germanAnswer}`).join("\n");navigator.clipboard.writeText(t),d(!0),setTimeout(()=>d(!1),2e3)},children:l?o(r,"result.copied"):o(r,"result.copy")}),(0,i.jsx)("button",{className:"btn btn-secondary",onClick:t,children:o(r,"result.newForm")})]})]})]})}function N({imageBase64:e,fields:t,onPositionsUpdate:r,onClose:n,locale:s}){let l,[o,d]=(0,a.useState)(t),[c,u]=(0,a.useState)(null),[m,h]=(0,a.useState)(!1),[g,p]=(0,a.useState)(!1),[x,f]=(0,a.useState)({x:0,y:0}),b=(0,a.useRef)(null),y=(e,t,r=!1)=>{e.stopPropagation(),u(t),f({x:"touches"in e?e.touches[0].clientX:e.clientX,y:"touches"in e?e.touches[0].clientY:e.clientY}),r?p(!0):h(!0)},j=(0,a.useCallback)(e=>{if(!c||!m&&!g||!b.current)return;"touchmove"===e.type&&e.cancelable&&e.preventDefault();let t="touches"in e?e.touches[0].clientX:e.clientX,r="touches"in e?e.touches[0].clientY:e.clientY,i=b.current.getBoundingClientRect(),a=(t-x.x)/i.width*100,n=(r-x.y)/i.height*100;d(e=>e.map(e=>{if(e.id!==c)return e;if(m){let t=Math.max(0,Math.min(100-e.position.width,e.position.x+a)),r=Math.max(0,Math.min(100-e.position.height,e.position.y+n));return{...e,position:{...e.position,x:t,y:r}}}if(g){let t=Math.max(5,Math.min(100-e.position.x,e.position.width+a)),r=Math.max(2,Math.min(100-e.position.y,e.position.height+n));return{...e,position:{...e.position,width:t,height:r}}}return e})),f({x:t,y:r})},[c,m,g,x]),v=(0,a.useCallback)(()=>{h(!1),p(!1)},[]);return(0,a.useEffect)(()=>(window.addEventListener("mousemove",j),window.addEventListener("mouseup",v),window.addEventListener("touchmove",j,{passive:!1}),window.addEventListener("touchend",v),()=>{window.removeEventListener("mousemove",j),window.removeEventListener("mouseup",v),window.removeEventListener("touchmove",j),window.removeEventListener("touchend",v)}),[j,v]),(0,i.jsxs)("div",{className:"position-adjuster-overlay",style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.95)",zIndex:1e3,display:"flex",flexDirection:"column",padding:"var(--spacing-md)"},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"var(--spacing-sm)",color:"white",flexWrap:"wrap",gap:"var(--spacing-sm)"},children:[(0,i.jsx)("h2",{style:{margin:0,fontSize:"1.1rem"},children:"ar"===s?"تعديل مواقع الحقول - اسحب المربعات لنقلها":"Feldpositionen anpassen - Boxen ziehen zum Verschieben"}),(0,i.jsxs)("div",{style:{display:"flex",gap:"var(--spacing-sm)"},children:[(0,i.jsx)("button",{className:"btn btn-secondary",onClick:()=>{d(t),u(null)},style:{fontSize:"0.875rem",padding:"0.5rem 1rem"},children:"ar"===s?"إعادة تعيين":"Zur\xfccksetzen"}),(0,i.jsx)("button",{className:"btn btn-secondary",onClick:n,style:{fontSize:"0.875rem",padding:"0.5rem 1rem"},children:"ar"===s?"إلغاء":"Abbrechen"}),(0,i.jsx)("button",{className:"btn btn-primary",onClick:()=>{r(o),n()},style:{fontSize:"0.875rem",padding:"0.5rem 1rem"},children:"ar"===s?"حفظ التغييرات":"Speichern"})]})]}),(0,i.jsx)("div",{onClick:()=>{u(null)},style:{flex:1,overflow:"auto",display:"flex",justifyContent:"center",alignItems:"flex-start",background:"rgba(0,0,0,0.5)",borderRadius:"var(--radius-md)",padding:"var(--spacing-sm)",touchAction:"none"},children:(0,i.jsxs)("div",{style:{position:"relative",display:"inline-block"},children:[(0,i.jsx)("img",{ref:b,src:e,alt:"Form",style:{maxWidth:"100%",maxHeight:"calc(100vh - 120px)",display:"block"}}),o.map(e=>{let t=e.id===c;return(0,i.jsxs)("div",{onMouseDown:t=>y(t,e.id),onTouchStart:t=>y(t,e.id),style:{position:"absolute",left:`${e.position.x}%`,top:`${e.position.y}%`,width:`${e.position.width}%`,height:`${e.position.height}%`,border:`2px solid ${t?"#00ff00":"rgba(255, 100, 100, 0.9)"}`,background:t?"rgba(0, 255, 0, 0.15)":"rgba(255, 100, 100, 0.1)",cursor:m?"grabbing":"grab",boxSizing:"border-box",borderRadius:"4px",transition:"border-color 0.15s, background 0.15s",display:"flex",flexDirection:"column",overflow:"visible"},children:[t&&(0,i.jsx)("div",{onClick:t=>{t.stopPropagation(),d(t=>t.filter(t=>t.id!==e.id)),c===e.id&&u(null)},onTouchStart:t=>{t.stopPropagation(),d(t=>t.filter(t=>t.id!==e.id)),c===e.id&&u(null)},style:{position:"absolute",top:"-12px",right:"-12px",width:"24px",height:"24px",background:"#ef4444",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"16px",cursor:"pointer",zIndex:50,boxShadow:"0 2px 4px rgba(0,0,0,0.3)",border:"2px solid white"},children:"\xd7"}),(0,i.jsx)("div",{style:{position:"absolute",bottom:"100%",left:"0",right:"0",marginBottom:"2px",display:"flex",alignItems:"center",gap:"4px"},children:(0,i.jsx)("span",{style:{background:t?"linear-gradient(135deg, #00ff00, #00cc00)":"linear-gradient(135deg, #ff6b6b, #ee5a5a)",color:t?"#000":"#fff",padding:"2px 6px",fontSize:"10px",fontWeight:600,borderRadius:"3px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"200px",boxShadow:"0 2px 4px rgba(0,0,0,0.3)"},children:((e,t=25)=>e.length<=t?e:e.slice(0,t)+"...")(e.germanQuestion)})}),e.germanAnswer&&(0,i.jsx)("div",{style:{width:"100%",height:"100%",padding:"2px 4px",fontSize:"11px",color:"#000",fontFamily:"Arial, sans-serif",whiteSpace:"pre-wrap",overflow:"hidden",lineHeight:"1.2",pointerEvents:"none"},children:e.germanAnswer}),(0,i.jsx)("div",{onMouseDown:t=>y(t,e.id,!0),onTouchStart:t=>y(t,e.id,!0),style:{position:"absolute",bottom:"-6px",right:"-6px",width:"14px",height:"14px",background:t?"linear-gradient(135deg, #00ff00, #00cc00)":"linear-gradient(135deg, #ff6b6b, #ee5a5a)",cursor:"nwse-resize",borderRadius:"3px",boxShadow:"0 2px 4px rgba(0,0,0,0.3)",border:"2px solid white"}}),t&&(0,i.jsxs)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(0,0,0,0.6)",borderRadius:"4px",padding:"4px 8px",display:"flex",alignItems:"center",gap:"4px"},children:[(0,i.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2",children:(0,i.jsx)("path",{d:"M5 9l-3 3 3 3M9 5l3-3 3 3M15 19l-3 3-3-3M19 9l3 3-3 3M2 12h20M12 2v20"})}),(0,i.jsx)("span",{style:{color:"white",fontSize:"10px"},children:"ar"===s?"اسحب":"Ziehen"})]})]},e.id)})]})}),c&&(0,i.jsx)("div",{style:{marginTop:"var(--spacing-sm)",padding:"var(--spacing-sm) var(--spacing-md)",background:"linear-gradient(135deg, rgba(0, 255, 0, 0.2), rgba(0, 200, 0, 0.1))",border:"1px solid rgba(0, 255, 0, 0.4)",borderRadius:"var(--radius-md)",color:"white",fontSize:"0.875rem"},children:(l=o.find(e=>e.id===c))?(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"0.5rem"},children:[(0,i.jsxs)("span",{style:{color:"#00ff00",fontWeight:600},children:["✓ ",l.germanQuestion]}),(0,i.jsxs)("span",{style:{fontFamily:"monospace",fontSize:"0.8rem",color:"rgba(255,255,255,0.8)"},children:["X: ",l.position.x.toFixed(1),"% | Y: ",l.position.y.toFixed(1),"% | W: ",l.position.width.toFixed(1),"% | H: ",l.position.height.toFixed(1),"%"]})]}):null})]})}var k=r(34020);function C({imageBase64:e,fields:t,onComplete:r,locale:n}){let[s,l]=(0,a.useState)([]),[o,d]=(0,a.useState)(null),[c,u]=(0,a.useState)(!1),[m,h]=(0,a.useState)({x:0,y:0}),[g,p]=(0,a.useState)(!0),[x,f]=(0,a.useState)(!1),b=(0,a.useRef)(null),y=(0,a.useRef)(null),j=(0,a.useRef)(null),[v,w]=(0,a.useState)(!1);(0,a.useEffect)(()=>{t.length>0&&0===s.length&&l(t.map((e,t)=>({id:e.id,text:e.existingValue||"",type:"text",x:e.position?.x||10,y:e.position?.y||10+5*t,width:e.position?.width,height:e.position?.height,fontSize:14,germanQuestion:e.germanQuestion,arabicQuestion:e.arabicQuestion,isTranslated:!1})))},[t]);let S=e=>{if(c)return;let t=b.current?.getBoundingClientRect();if(!t)return;let r=(e.clientX-t.left)/t.width*100,i=(e.clientY-t.top)/t.height*100,a={id:`box_${Date.now()}`,text:"",type:"text",x:r,y:i,fontSize:14};l(e=>[...e,a]),d(a.id),p(!1)},N=(e,t)=>{e.stopPropagation(),d(t),u(!0),h({x:"touches"in e?e.touches[0].clientX:e.clientX,y:"touches"in e?e.touches[0].clientY:e.clientY})},C=e=>{if(!c||!o||!b.current)return;"touches"in e&&e.cancelable&&e.preventDefault();let t="touches"in e?e.touches[0].clientX:e.clientX,r="touches"in e?e.touches[0].clientY:e.clientY,i=b.current.getBoundingClientRect(),a=(t-m.x)/i.width*100,n=(r-m.y)/i.height*100;l(e=>e.map(e=>e.id!==o?e:{...e,x:e.x+a,y:e.y+n})),h({x:t,y:r})},z=()=>{u(!1)},F=(e,t)=>{l(r=>r.map(r=>{if(r.id!==e)return r;if("signature"===r.type){let e=Math.max(.5,Math.min(3,(r.scale||1)+.1*t));return{...r,scale:e}}return{...r,fontSize:Math.max(8,Math.min(32,r.fontSize+t))}}))},I=async()=>{w(!0);try{let e=s.filter(e=>e.text.trim()&&!e.isTranslated&&"signature"!==e.type);if(0===e.length)return void w(!1);let t=e.map(e=>({fieldId:e.id,arabicAnswer:e.text})),r=await fetch("/api/translate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({answers:t})}),i=await r.json();i.success&&i.translations&&l(e=>e.map(e=>{let t=i.translations.find(t=>t.fieldId===e.id);return t?{...e,text:t.germanAnswer,isTranslated:!0}:e}))}catch(e){console.error("Translation failed",e)}finally{w(!1)}},D=s.find(e=>e.id===o);return(0,i.jsxs)("div",{className:"direct-editor-container",style:{display:"flex",flexDirection:"column",gap:"var(--spacing-md)",height:"calc(100vh - 150px)",minHeight:"600px"},children:[(0,i.jsxs)("div",{style:{display:"flex",gap:"var(--spacing-sm)",padding:"var(--spacing-sm)",background:"var(--glass-bg)",borderRadius:"var(--radius-md)",flexWrap:"wrap",alignItems:"center",justifyContent:"space-between"},children:[(0,i.jsxs)("div",{style:{display:"flex",gap:"var(--spacing-sm)",alignItems:"center"},children:[(0,i.jsxs)("button",{className:"btn btn-secondary",onClick:S,style:{fontSize:"0.875rem"},children:[(0,i.jsx)("span",{children:"➕"})," ","ar"===n?"نص حر":"Text"]}),(0,i.jsxs)("button",{className:"btn btn-secondary",onClick:()=>f(!0),style:{fontSize:"0.875rem"},children:[(0,i.jsx)("span",{children:"✍️"})," ","ar"===n?"توقيع":"Unterschrift"]}),D&&(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",background:"rgba(255,255,255,0.1)",padding:"4px 8px",borderRadius:"4px"},children:[(0,i.jsx)("button",{onClick:()=>F(D.id,-2),style:{padding:"0 4px",cursor:"pointer"},children:"-"}),(0,i.jsx)("span",{style:{fontSize:"0.8rem",color:"white"},children:"signature"===D.type?(D.scale||1).toFixed(1)+"x":D.fontSize+"px"}),(0,i.jsx)("button",{onClick:()=>F(D.id,2),style:{padding:"0 4px",cursor:"pointer"},children:"+"})]})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:"var(--spacing-sm)"},children:[(0,i.jsxs)("button",{className:"btn btn-secondary",onClick:I,disabled:v,style:{fontSize:"0.875rem"},children:[v?(0,i.jsx)("span",{className:"loading-spinner",style:{width:14,height:14}}):"\uD83C\uDF0D"," ","ar"===n?"ترجمة":"\xdcbersetzen"]}),(0,i.jsx)("button",{className:"btn btn-primary",onClick:()=>{if(!b.current)return;let e=b.current.getBoundingClientRect();r(s.filter(e=>"signature"===e.type||e.text.trim()).map(t=>{let r=document.getElementById(t.id);if(r){let i=r.getBoundingClientRect();return{...t,width:i.width/e.width*100,height:i.height/e.height*100}}return t}))},style:{fontSize:"0.875rem"},children:"ar"===n?"✅ إنهاء":"✅ Fertig"})]})]}),(0,i.jsxs)("div",{ref:y,className:"image-container",style:{flex:1,overflow:"auto",background:"var(--color-neutral-900)",borderRadius:"var(--radius-lg)",padding:"var(--spacing-md)",position:"relative",touchAction:"none"},onMouseMove:C,onTouchMove:C,onMouseUp:z,onTouchEnd:z,onMouseLeave:z,onDragOver:e=>{e.preventDefault()},onDrop:e=>{e.preventDefault();let r=b.current?.getBoundingClientRect();if(!r)return;let i=e.dataTransfer.getData("fieldId"),a=e.dataTransfer.getData("text");if(!a)return;let n=(e.clientX-r.left)/r.width*100,s=(e.clientY-r.top)/r.height*100,o=t.find(e=>e.id===i),c={id:`box_${Date.now()}`,text:a,type:"text",x:Math.max(0,Math.min(95,n)),y:Math.max(0,Math.min(95,s)),fontSize:14,germanQuestion:o?.germanQuestion,arabicQuestion:o?.arabicQuestion,isTranslated:!1};l(e=>[...e,c]),d(c.id),p(!1)},children:[g&&0===s.length&&(0,i.jsxs)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(0,0,0,0.9)",padding:"var(--spacing-xl)",borderRadius:"var(--radius-lg)",textAlign:"center",zIndex:100,maxWidth:"400px"},children:[(0,i.jsx)("h3",{style:{color:"var(--color-primary-400)",marginBottom:"var(--spacing-md)"},children:"ar"===n?"كيفية الاستخدام":"Anleitung"}),(0,i.jsxs)("ol",{style:{color:"white",textAlign:"ar"===n?"right":"left",lineHeight:1.8},children:[(0,i.jsx)("li",{children:"ar"===n?"اضغط على أي حقل للكتابة فيه":"Klicken Sie auf ein Feld, um zu schreiben"}),(0,i.jsx)("li",{children:"ar"===n?"استخدم شريط الأدوات في الأعلى لأدوات إضافية":"Verwenden Sie die Toolbar oben f\xfcr weitere Tools"}),(0,i.jsx)("li",{children:"ar"===n?'عند الانتهاء، اضغط "إنهاء" للحفظ':'Klicken Sie auf "Fertig", um zu speichern'})]}),(0,i.jsx)("button",{className:"btn btn-secondary",onClick:()=>p(!1),style:{marginTop:"var(--spacing-md)"},children:"ar"===n?"ابدأ التحرير":"Bearbeitung starten"})]}),(0,i.jsxs)("div",{style:{position:"relative",display:"inline-block"},children:[(0,i.jsx)("img",{ref:b,src:e,alt:"Form",onClick:S,style:{maxWidth:"100%",display:"block",borderRadius:"var(--radius-md)",pointerEvents:"none",userSelect:"none"}}),s.map(e=>(0,i.jsxs)("div",{id:e.id,style:{cursor:"default",userSelect:"none",transform:"translate(0, 0)",position:"absolute",left:`${e.x}%`,top:`${e.y}%`,zIndex:o===e.id?20:10},children:["signature"===e.type&&e.imageUrl?(0,i.jsx)("div",{onMouseDown:t=>N(t,e.id),onTouchStart:t=>N(t,e.id),style:{cursor:c?"grabbing":"grab"},children:(0,i.jsx)("img",{src:e.imageUrl,alt:"signature",draggable:!1,style:{border:o===e.id?"2px solid var(--color-primary-500)":"1px dashed transparent",transform:`scale(${e.scale||1})`,transformOrigin:"top left"}})}):(0,i.jsxs)("div",{style:{position:"relative"},children:[o===e.id&&(0,i.jsx)("div",{onMouseDown:t=>N(t,e.id),onTouchStart:t=>N(t,e.id),style:{position:"absolute",top:"-24px",left:0,background:"var(--color-primary-600)",borderRadius:"4px 4px 0 0",padding:"2px 8px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"grab",zIndex:30,color:"white",fontSize:"12px",whiteSpace:"nowrap"},title:"ar"===n?"اسحب للتحريك":"Ziehen zum Bewegen",children:e.arabicQuestion?(0,i.jsx)("span",{style:{maxWidth:"150px",overflow:"hidden",textOverflow:"ellipsis"},children:e.arabicQuestion}):(0,i.jsx)("span",{children:"✋"})}),!e.text&&e.arabicQuestion&&o!==e.id&&(0,i.jsx)("div",{style:{position:"absolute",top:"-20px",right:0,color:"var(--color-primary-300)",fontSize:"11px",background:"rgba(0,0,0,0.6)",padding:"2px 4px",borderRadius:"4px",pointerEvents:"none",whiteSpace:"nowrap",maxWidth:"200px",overflow:"hidden",textOverflow:"ellipsis",direction:"rtl"},children:e.arabicQuestion}),(0,i.jsx)("textarea",{value:e.text,dir:"auto",placeholder:e.arabicQuestion||("ar"===n?"اكتب هنا...":"Hier schreiben..."),onChange:t=>{var r,i;return r=e.id,i=t.target.value,void l(e=>e.map(e=>e.id===r?{...e,text:i,isTranslated:!1}:e))},onClick:t=>{t.stopPropagation(),d(e.id)},style:{background:"rgba(255, 255, 255, 0.7)",border:o===e.id?"2px solid var(--color-primary-500)":"1px solid rgba(0,0,0,0.2)",borderRadius:"4px",padding:"4px 8px",fontSize:`${e.fontSize}px`,fontFamily:"Arial, sans-serif",color:"#000",fontWeight:"bold",minWidth:"60px",minHeight:"30px",outline:"none",resize:"both",overflow:"hidden",whiteSpace:"pre-wrap",width:e.width?`${e.width}px`:e.text?"auto":"120px"},onMouseDown:e=>e.stopPropagation()})]}),o===e.id&&(0,i.jsx)("button",{onClick:t=>{var r;t.stopPropagation(),r=e.id,l(e=>e.filter(e=>e.id!==r)),o===r&&d(null)},style:{position:"absolute",top:"-20px",right:"-20px",width:"24px",height:"24px",borderRadius:"50%",background:"#ef4444",color:"white",border:"none",cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center",justifyContent:"center",zIndex:30,boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},children:"\xd7"})]},e.id))]})]}),x&&(0,i.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.8)",zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,i.jsxs)("div",{className:"glass-card",style:{padding:"2rem",width:"90%",maxWidth:"500px"},children:[(0,i.jsx)("h3",{style:{marginBottom:"1rem",color:"white"},children:"ar"===n?"توقيع":"Unterschrift"}),(0,i.jsx)("div",{style:{background:"white",borderRadius:"4px",overflow:"hidden"},children:(0,i.jsx)(k.A,{ref:j,canvasProps:{width:450,height:200,className:"sigCanvas",style:{width:"100%",height:"200px"}},backgroundColor:"rgba(255,255,255,0)"})}),(0,i.jsxs)("div",{style:{display:"flex",gap:"1rem",marginTop:"1rem",justifyContent:"flex-end"},children:[(0,i.jsx)("button",{className:"btn btn-secondary",onClick:()=>{j.current?.clear()},children:"ar"===n?"مسح":"L\xf6schen"}),(0,i.jsx)("button",{className:"btn btn-secondary",onClick:()=>f(!1),children:"ar"===n?"إلغاء":"Abbrechen"}),(0,i.jsx)("button",{className:"btn btn-primary",onClick:()=>{if(j.current){let e=j.current.toDataURL(),t={id:`sig_${Date.now()}`,text:"Signature",type:"signature",imageUrl:e,x:40,y:40,fontSize:14,scale:1};l(e=>[...e,t]),d(t.id),f(!1)}},children:"ar"===n?"حفظ":"Speichern"})]})]})})]})}function z({user:e,userCredits:t,setUserCredits:r,onAuthRequired:l,onBuyCredits:d,onBack:c}){(0,n.useSearchParams)();let{locale:u,deductCredits:m,step:h,setStep:g}=(0,s.nm)(),[x,f]=(0,a.useState)(null),[j,v]=(0,a.useState)([]),[w,k]=(0,a.useState)(null),[z,F]=(0,a.useState)(!1),[I,D]=(0,a.useState)(null),[T,B]=(0,a.useState)(!1),[_,P]=(0,a.useState)(!0),A=async()=>{if(x){if(t<1){D(o(u,"credits.insufficient")),d();return}F(!0),D(null);try{let e=await fetch("/api/analyze",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageBase64:x})}),t=await e.json();if(!t.success||!t.fields?.length)return void D(o(u,"errors.noQuestions"));v(t.fields),g("questions")}catch{D(o(u,"errors.analyze"))}finally{F(!1)}}},E=async e=>{F(!0),D(null);try{let t=await fetch("/api/credits/deduct",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:1})}),i=await t.json();if(!i.success)return void D(i.error||o(u,"credits.insufficient"));r(i.credits);let a=j.map(t=>({fieldId:t.id,germanQuestion:t.germanQuestion,arabicAnswer:e[t.id]||""})),n=await fetch("/api/translate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({answers:a})}),s=await n.json();if(!s.success)return void D(o(u,"errors.submit"));let l=j.map(t=>{let r=s.translations?.find(e=>e.fieldId===t.id||e.fieldId?.toLowerCase()===t.id?.toLowerCase()),i=r?.germanAnswer||"";return{id:t.id,germanQuestion:t.germanQuestion,germanAnswer:i||e[t.id]||"",position:t.position,prefilled:!1,existingValue:null}});k({fields:l,generatedAt:new Date().toISOString(),creditsUsed:1,originalImage:x||void 0}),g("result")}catch{D(o(u,"errors.submit"))}finally{F(!1)}},L=async e=>{F(!0),D(null);try{let t=e.filter(e=>!e.isTranslated).map(e=>({fieldId:e.id,arabicAnswer:e.text})),i=[];if(t.length>0){let e=await fetch("/api/translate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({answers:t})}),r=await e.json();if(!r.success)return void D(o(u,"errors.submit"));i=r.translations||[]}let a=e.map(e=>{let t=i.find(t=>t.fieldId===e.id||t.fieldId?.toLowerCase()===e.id?.toLowerCase()),r=t?.germanAnswer||e.text;return{id:e.id,germanQuestion:e.germanQuestion||"Freitext",germanAnswer:r,position:{x:e.x,y:e.y,width:e.width||30,height:e.height||4},prefilled:!1,existingValue:null}}),n=await fetch("/api/credits/deduct",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:1})});if(n.ok){let e=await n.json();e.success&&(r(e.remainingCredits),m(1))}k({fields:a,generatedAt:new Date().toISOString(),creditsUsed:1,originalImage:x||void 0}),g("result")}catch{D(o(u,"errors.submit"))}finally{F(!1)}};return e?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{style:{marginBottom:"1rem",display:"flex",alignItems:"center"},children:c&&(0,i.jsxs)("button",{onClick:c,className:"btn btn-secondary",style:{marginRight:"1rem",padding:"0.4rem 0.8rem",fontSize:"0.9rem"},children:["← ","ar"===u?"الرجوع":"Zur\xfcck"]})}),(0,i.jsx)(p,{currentStep:h,locale:u}),(0,i.jsxs)("div",{className:"main-content",children:[I&&(0,i.jsx)("div",{className:"alert alert-error",style:{marginBottom:"1.5rem"},children:I}),"upload"===h&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(b,{onImageSelected:(e,t)=>{f(t),D(null)},onImageRemoved:()=>{f(null),v([]),g("upload")},currentImage:x,isLoading:z,locale:u}),x&&(0,i.jsx)("button",{className:"btn btn-primary btn-lg",style:{width:"100%",marginTop:"1.5rem"},onClick:A,disabled:z,children:z?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{className:"loading-spinner",style:{width:20,height:20}}),o(u,"upload.analyzing")]}):o(u,"upload.analyze")})]}),"questions"===h&&j.length>0&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"var(--spacing-md)",padding:"var(--spacing-sm)",background:"var(--glass-bg)",borderRadius:"var(--radius-md)",flexWrap:"wrap",gap:"var(--spacing-sm)"},children:[(0,i.jsx)("span",{style:{color:"var(--color-neutral-300)",fontSize:"0.875rem"},children:"ar"===u?"خيارات التحرير:":"Bearbeitungsoptionen:"}),(0,i.jsxs)("div",{style:{display:"flex",gap:"var(--spacing-xs)",flexWrap:"wrap"},children:[(0,i.jsxs)("button",{className:"btn btn-secondary",onClick:()=>B(!0),style:{fontSize:"0.75rem",padding:"0.4rem 0.8rem",display:"flex",alignItems:"center",gap:"4px"},children:[(0,i.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,i.jsx)("path",{d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"ar"===u?"تعديل المواقع":"Positionen anpassen"]}),(0,i.jsx)("div",{style:{width:"1px",background:"var(--color-neutral-700)",margin:"0 4px"}}),(0,i.jsx)("button",{className:`btn ${_?"btn-primary":"btn-secondary"}`,onClick:()=>P(!0),style:{fontSize:"0.75rem",padding:"0.4rem 0.8rem"},children:"ar"===u?"✏️ كتابة مباشرة":"✏️ Direkt schreiben"}),(0,i.jsx)("button",{className:`btn ${!_?"btn-primary":"btn-secondary"}`,onClick:()=>P(!1),style:{fontSize:"0.75rem",padding:"0.4rem 0.8rem"},children:"ar"===u?"\uD83D\uDCDD نموذج الأسئلة":"\uD83D\uDCDD Fragenformular"})]})]}),_&&x&&(0,i.jsx)(C,{imageBase64:x,fields:j,onComplete:L,locale:u}),!_&&(0,i.jsx)(y,{fields:j,onSubmit:E,isLoading:z,locale:u,imageBase64:x}),z&&(0,i.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:(0,i.jsxs)("div",{style:{textAlign:"center",color:"white"},children:[(0,i.jsx)("div",{className:"loading-spinner",style:{width:40,height:40,margin:"0 auto 1rem"}}),(0,i.jsx)("p",{children:"ar"===u?"جاري الترجمة والمعالجة...":"\xdcbersetzen und verarbeiten..."})]})})]}),"result"===h&&w&&(0,i.jsx)(S,{result:w,onNewForm:()=>{f(null),v([]),k(null),g("upload"),D(null)},locale:u,onAdjustPositions:()=>B(!0),imageBase64:x})]}),T&&x&&j.length>0&&(0,i.jsx)(N,{imageBase64:x,fields:j.filter(e=>e.position).map(e=>{let t=w?.fields.find(t=>t.id===e.id);return{id:e.id,germanQuestion:e.germanQuestion,position:e.position,germanAnswer:t?.germanAnswer}}),onPositionsUpdate:e=>{v(t=>t.map(t=>{let r=e.find(e=>e.id===t.id);return r?{...t,position:r.position}:t})),w&&k(t=>t?{...t,fields:t.fields.map(t=>{let r=e.find(e=>e.id===t.id);return r?{...t,position:r.position}:t})}:null)},onClose:()=>B(!1),locale:u})]}):(l(),null)}function F({onBack:e}){let{locale:t}=(0,s.nm)(),[r,n]=(0,a.useState)(null),[l,o]=(0,a.useState)(null),[d,c]=(0,a.useState)(!1),[u,m]=(0,a.useState)(null),h=async()=>{if(r){c(!0),m(null);try{let e=await fetch("/api/explain",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageBase64:r})}),t=await e.json();if(!t.success)throw Error(t.error||"Failed");o(t.explanation)}catch(e){console.error(e),m("ar"===t?"فشل تحليل المستند":"Fehler bei der Dokumentenanalyse")}finally{c(!1)}}};return(0,i.jsxs)("div",{className:"glass-card animate-scale-in",children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"1.5rem"},children:[(0,i.jsx)("button",{onClick:e,style:{background:"none",border:"none",color:"var(--color-neutral-300)",cursor:"pointer",marginRight:"1rem",fontSize:"1.2rem"},children:"←"}),(0,i.jsx)("h2",{className:"text-xl font-bold text-white",children:"ar"===t?"شرح المستندات":"Dokumentenerkl\xe4rung"})]}),l?(0,i.jsxs)("div",{className:"animate-fade-in",children:[(0,i.jsxs)("div",{style:{background:"rgba(0,0,0,0.3)",padding:"1.5rem",borderRadius:"var(--radius-lg)",border:"1px solid var(--color-neutral-700)",whiteSpace:"pre-wrap",lineHeight:"1.8",direction:"rtl",textAlign:"right",color:"var(--color-neutral-100)",maxHeight:"400px",overflowY:"auto"},children:[(0,i.jsx)("h3",{style:{color:"var(--color-primary-400)",marginBottom:"1rem"},children:"\uD83D\uDCDD الشرح باللهجة السورية:"}),l]}),(0,i.jsx)("button",{className:"btn btn-secondary",style:{width:"100%",marginTop:"1.5rem"},onClick:()=>{n(null),o(null)},children:"ar"===t?"شرح مستند آخر":"Anderes Dokument erkl\xe4ren"})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("p",{style:{color:"var(--color-neutral-300)",marginBottom:"1.5rem"},children:"ar"===t?"قم برفع صورة أو ملف PDF وسيقوم النظام بشرح محتواه باللهجة السورية المبسطة.":"Laden Sie ein Dokument hoch (Bild oder PDF), um eine Erkl\xe4rung im syrischen Dialekt zu erhalten."}),(0,i.jsx)(b,{onImageSelected:(e,t)=>{n(t),m(null),o(null)},onImageRemoved:()=>n(null),currentImage:r,isLoading:d,locale:t,accept:"image/*,application/pdf"}),r&&(0,i.jsx)("button",{className:"btn btn-primary btn-lg",style:{width:"100%",marginTop:"1.5rem"},onClick:h,disabled:d,children:d?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{className:"loading-spinner",style:{width:20,height:20}}),"ar"===t?"جاري التحليل...":"Analysieren..."]}):"ar"===t?"اشرح لي المستند":"Dokument erkl\xe4ren"}),u&&(0,i.jsx)("div",{className:"alert alert-error",style:{marginTop:"1rem"},children:u})]})]})}var I=r(50550);I.KQ.register({family:"Roboto",src:"https://cdnjs.cloudflare.com/ajax/libs/ink/3.1.10/fonts/Roboto/roboto-light-webfont.ttf"});let D=I.vv.create({page:{flexDirection:"column",backgroundColor:"#FFFFFF",padding:30,fontFamily:"Helvetica"},header:{marginBottom:20,borderBottomWidth:1,borderBottomColor:"#112233",paddingBottom:10},name:{fontSize:24,fontWeight:"bold",textTransform:"uppercase",color:"#112233"},title:{fontSize:14,color:"#556677",marginTop:4},contact:{fontSize:10,marginTop:4,color:"#334455"},section:{margin:10,padding:10,flexGrow:1},sectionTitle:{fontSize:14,fontWeight:"bold",marginTop:15,marginBottom:5,borderBottomWidth:1,borderBottomColor:"#CCCCCC",textTransform:"uppercase",color:"#112233"},entryTitle:{fontSize:12,fontWeight:"bold",marginTop:8},entrySubtitle:{fontSize:10,fontStyle:"italic",marginBottom:2,color:"#556677"},entryDate:{fontSize:10,color:"#777777",marginBottom:4},text:{fontSize:10,lineHeight:1.5,textAlign:"justify"},skillItem:{fontSize:10,marginRight:10,padding:4,backgroundColor:"#EEEEEE",borderRadius:2},skillsContainer:{flexDirection:"row",flexWrap:"wrap",marginTop:5}}),T=({data:e})=>(0,i.jsx)(I.yo,{children:(0,i.jsxs)(I.YW,{size:"A4",style:D.page,children:[(0,i.jsxs)(I.Ss,{style:D.header,children:[(0,i.jsxs)(I.EY,{style:D.name,children:[e.personalInfo.firstName," ",e.personalInfo.lastName]}),(0,i.jsx)(I.EY,{style:D.title,children:e.personalInfo.jobTitle}),(0,i.jsxs)(I.EY,{style:D.contact,children:[e.personalInfo.email," | ",e.personalInfo.phone," | ",e.personalInfo.address,e.personalInfo.linkedIn?` | ${e.personalInfo.linkedIn}`:""]})]}),e.summary&&(0,i.jsxs)(I.Ss,{children:[(0,i.jsx)(I.EY,{style:D.sectionTitle,children:"Profil"}),(0,i.jsx)(I.EY,{style:D.text,children:e.summary})]}),(0,i.jsxs)(I.Ss,{children:[(0,i.jsx)(I.EY,{style:D.sectionTitle,children:"Berufserfahrung"}),e.experience.map((e,t)=>(0,i.jsxs)(I.Ss,{style:{marginBottom:8},children:[(0,i.jsx)(I.EY,{style:D.entryTitle,children:e.title}),(0,i.jsxs)(I.EY,{style:D.entrySubtitle,children:[e.company,", ",e.location]}),(0,i.jsxs)(I.EY,{style:D.entryDate,children:[e.startDate," - ",e.endDate]}),(0,i.jsx)(I.EY,{style:D.text,children:e.description})]},t))]}),(0,i.jsxs)(I.Ss,{children:[(0,i.jsx)(I.EY,{style:D.sectionTitle,children:"Ausbildung"}),e.education.map((e,t)=>(0,i.jsxs)(I.Ss,{style:{marginBottom:8},children:[(0,i.jsx)(I.EY,{style:D.entryTitle,children:e.degree}),(0,i.jsxs)(I.EY,{style:D.entrySubtitle,children:[e.institution,", ",e.location]}),(0,i.jsxs)(I.EY,{style:D.entryDate,children:[e.startDate," - ",e.endDate]}),e.description&&(0,i.jsx)(I.EY,{style:D.text,children:e.description})]},t))]}),(0,i.jsxs)(I.Ss,{children:[(0,i.jsx)(I.EY,{style:D.sectionTitle,children:"Kenntnisse & F\xe4higkeiten"}),(0,i.jsx)(I.Ss,{style:D.skillsContainer,children:e.skills.map((e,t)=>(0,i.jsx)(I.EY,{style:D.skillItem,children:e},t))})]}),(0,i.jsxs)(I.Ss,{children:[(0,i.jsx)(I.EY,{style:D.sectionTitle,children:"Sprachen"}),(0,i.jsx)(I.Ss,{style:D.skillsContainer,children:e.languages.map((e,t)=>(0,i.jsxs)(I.EY,{style:D.skillItem,children:[e.language," (",e.level,")"]},t))})]})]})});function B({onBack:e,user:t,userCredits:r,setUserCredits:n,onAuthRequired:l,onBuyCredits:o}){let{locale:d}=(0,s.nm)(),[c,u]=(0,a.useState)("type-selection"),[m,h]=(0,a.useState)(null),[g,p]=(0,a.useState)({firstName:"",lastName:"",email:"",phone:"",address:"",jobTitle:"",linkedIn:""}),[x,f]=(0,a.useState)([{title:"",company:"",startDate:"",endDate:"",description:"",location:""}]),[b,y]=(0,a.useState)([{degree:"",institution:"",startDate:"",endDate:"",location:"",description:""}]),[j,v]=(0,a.useState)([""]),[w,S]=(0,a.useState)([{language:"",level:""}]),[N,k]=(0,a.useState)(""),[C,z]=(0,a.useState)(null),F=async()=>{if(!t)return void l();if(r<3)return void o();u("generating");try{let e=await fetch("/api/credits/deduct",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:3})}),t=await e.json();if(!t.success){alert(t.error||("ar"===d?"رصيد غير كافٍ":"Nicht gen\xfcgend Guthaben")),u("form");return}n(t.credits);let r=await fetch("/api/cv/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({personalInfo:g,experience:x,education:b,skills:j,languages:w,summary:N,targetFormat:m})}),i=await r.json();i.success?(z(i.cvData),u("result")):(alert("Error generating CV: "+i.error),u("form"))}catch(e){console.error("Error:",e),alert("An unexpected error occurred."),u("form")}};return"type-selection"===c?(0,i.jsxs)("div",{className:"glass-card animate-scale-in",children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"1.5rem"},children:[(0,i.jsx)("button",{onClick:e,style:{background:"none",border:"none",color:"var(--color-neutral-300)",cursor:"pointer",marginRight:"1rem",fontSize:"1.2rem"},children:"←"}),(0,i.jsx)("h2",{className:"text-xl font-bold text-white",children:"ar"===d?"إنشاء سيرة ذاتية":"Lebenslauf erstellen"})]}),(0,i.jsxs)("div",{style:{display:"grid",gap:"1.5rem",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))"},children:[(0,i.jsxs)("div",{className:"feature-card",style:{opacity:.6,cursor:"not-allowed",background:"linear-gradient(135deg, rgba(59, 130, 246, 0.2), rgba(37, 99, 235, 0.1))"},children:[(0,i.jsx)("div",{className:"feature-icon",style:{background:"var(--color-primary-600)"},children:"\uD83C\uDFA8"}),(0,i.jsx)("h3",{className:"feature-title",children:"ar"===d?"سيرة ذاتية بتصميم":"Design-Lebenslauf"}),(0,i.jsx)("p",{className:"feature-desc",children:"ar"===d?"قريباً...":"Bald verf\xfcgbar..."})]}),(0,i.jsxs)("div",{onClick:()=>{h("ats"),u("form")},className:"feature-card",style:{background:"linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(5, 150, 105, 0.1))",cursor:"pointer"},children:[(0,i.jsx)("div",{className:"feature-icon",style:{background:"var(--color-success-600)"},children:"\uD83E\uDD16"}),(0,i.jsx)("h3",{className:"feature-title",children:"ar"===d?"سيرة ذاتية ATS":"ATS-Lebenslauf"}),(0,i.jsx)("p",{className:"feature-desc",children:"ar"===d?"سيرة ذاتية احترافية محسنة لأنظمة التوظيف.":"Optimiert f\xfcr ATS-Systeme."}),(0,i.jsx)("span",{className:"text-xs text-primary-300 mt-2 block",children:"ar"===d?`تكلفة الخدمة: 3 رصيد`:"Kosten: 3 Credits"})]})]})]}):"form"===c?(0,i.jsxs)("div",{className:"glass-card animate-scale-in",style:{maxWidth:"800px",margin:"0 auto"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"1.5rem"},children:[(0,i.jsx)("button",{onClick:()=>u("type-selection"),style:{background:"none",border:"none",color:"var(--color-neutral-300)",cursor:"pointer",marginRight:"1rem",fontSize:"1.2rem"},children:"←"}),(0,i.jsx)("h2",{className:"text-xl font-bold text-white",children:"ar"===d?"أدخل معلوماتك":"Geben Sie Ihre Daten ein"})]}),(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[(0,i.jsxs)("section",{children:[(0,i.jsx)("h3",{className:"text-lg font-semibold mb-4 text-primary-400",children:"ar"===d?"المعلومات الشخصية":"Pers\xf6nliche Daten"}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,i.jsx)("input",{type:"text",placeholder:"ar"===d?"الاسم الأول":"Vorname",className:"input-field",value:g.firstName,onChange:e=>p({...g,firstName:e.target.value})}),(0,i.jsx)("input",{type:"text",placeholder:"ar"===d?"الاسم الأخير":"Nachname",className:"input-field",value:g.lastName,onChange:e=>p({...g,lastName:e.target.value})}),(0,i.jsx)("input",{type:"text",placeholder:"ar"===d?"المسمى الوظيفي المستهدف":"Angestrebte Position",className:"input-field col-span-2",value:g.jobTitle,onChange:e=>p({...g,jobTitle:e.target.value})}),(0,i.jsx)("input",{type:"email",placeholder:"Email",className:"input-field",value:g.email,onChange:e=>p({...g,email:e.target.value})}),(0,i.jsx)("input",{type:"tel",placeholder:"ar"===d?"رقم الهاتف":"Telefonnummer",className:"input-field",value:g.phone,onChange:e=>p({...g,phone:e.target.value})}),(0,i.jsx)("input",{type:"text",placeholder:"ar"===d?"العنوان":"Adresse",className:"input-field col-span-2",value:g.address,onChange:e=>p({...g,address:e.target.value})}),(0,i.jsx)("input",{type:"text",placeholder:"LinkedIn URL",className:"input-field col-span-2",value:g.linkedIn,onChange:e=>p({...g,linkedIn:e.target.value})})]})]}),(0,i.jsxs)("section",{children:[(0,i.jsx)("h3",{className:"text-lg font-semibold mb-4 text-primary-400",children:"ar"===d?"الملف المهني":"Profil"}),(0,i.jsx)("textarea",{placeholder:"ar"===d?"اكتب نبذة مهنية عنك (بالعربية)... وسيقوم الذكاء الاصطناعي بصياغتها بالألمانية.":"Beschreiben Sie Ihr Profil...",className:"input-field w-full h-32",value:N,onChange:e=>k(e.target.value)})]}),(0,i.jsxs)("section",{children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold text-primary-400",children:"ar"===d?"الخبرة العملية":"Berufserfahrung"}),(0,i.jsxs)("button",{onClick:()=>f([...x,{title:"",company:"",startDate:"",endDate:"",description:"",location:""}]),className:"btn btn-sm btn-outline",children:["+ ","ar"===d?"إضافة":"Hinzuf\xfcgen"]})]}),x.map((e,t)=>(0,i.jsxs)("div",{className:"p-4 border border-neutral-700 rounded-lg mb-4 bg-white/5",children:[(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-2",children:[(0,i.jsx)("input",{type:"text",placeholder:"ar"===d?"المسمى الوظيفي":"Position",className:"input-field",value:e.title,onChange:e=>{let r=[...x];r[t].title=e.target.value,f(r)}}),(0,i.jsx)("input",{type:"text",placeholder:"ar"===d?"اسم الشركة":"Firma",className:"input-field",value:e.company,onChange:e=>{let r=[...x];r[t].company=e.target.value,f(r)}}),(0,i.jsx)("input",{type:"text",placeholder:"ar"===d?"تاريخ البدء (MM/YYYY)":"Von (MM/JJJJ)",className:"input-field",value:e.startDate,onChange:e=>{let r=[...x];r[t].startDate=e.target.value,f(r)}}),(0,i.jsx)("input",{type:"text",placeholder:"ar"===d?'تاريخ الانتهاء (أو "حاضر")':'Bis (oder "Aktuell")',className:"input-field",value:e.endDate,onChange:e=>{let r=[...x];r[t].endDate=e.target.value,f(r)}})]}),(0,i.jsx)("textarea",{placeholder:"ar"===d?"وصف المهام والإنجازات...":"Beschreibung...",className:"input-field w-full h-24 mb-2",value:e.description,onChange:e=>{let r=[...x];r[t].description=e.target.value,f(r)}}),(0,i.jsx)("button",{onClick:()=>f(x.filter((e,r)=>r!==t)),className:"text-red-400 text-sm hover:text-red-300",children:"ar"===d?"حذف":"L\xf6schen"})]},t))]}),(0,i.jsxs)("section",{children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold text-primary-400",children:"ar"===d?"التعليم":"Ausbildung"}),(0,i.jsxs)("button",{onClick:()=>y([...b,{degree:"",institution:"",startDate:"",endDate:"",location:"",description:""}]),className:"btn btn-sm btn-outline",children:["+ ","ar"===d?"إضافة":"Hinzuf\xfcgen"]})]}),b.map((e,t)=>(0,i.jsxs)("div",{className:"p-4 border border-neutral-700 rounded-lg mb-4 bg-white/5",children:[(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-2",children:[(0,i.jsx)("input",{type:"text",placeholder:"ar"===d?"الدرجة العلمية":"Abschluss",className:"input-field",value:e.degree,onChange:e=>{let r=[...b];r[t].degree=e.target.value,y(r)}}),(0,i.jsx)("input",{type:"text",placeholder:"ar"===d?"المؤسسة التعليمية":"Institution",className:"input-field",value:e.institution,onChange:e=>{let r=[...b];r[t].institution=e.target.value,y(r)}}),(0,i.jsx)("input",{type:"text",placeholder:"ar"===d?"تاريخ البدء":"Von",className:"input-field",value:e.startDate,onChange:e=>{let r=[...b];r[t].startDate=e.target.value,y(r)}}),(0,i.jsx)("input",{type:"text",placeholder:"ar"===d?"تاريخ الانتهاء":"Bis",className:"input-field",value:e.endDate,onChange:e=>{let r=[...b];r[t].endDate=e.target.value,y(r)}})]}),(0,i.jsx)("button",{onClick:()=>y(b.filter((e,r)=>r!==t)),className:"text-red-400 text-sm hover:text-red-300",children:"ar"===d?"حذف":"L\xf6schen"})]},t))]}),(0,i.jsxs)("section",{children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold text-primary-400",children:"ar"===d?"المهارات":"Kenntnisse"}),(0,i.jsxs)("button",{onClick:()=>v([...j,""]),className:"btn btn-sm btn-outline",children:["+ ","ar"===d?"إضافة":"Hinzuf\xfcgen"]})]}),(0,i.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:j.map((e,t)=>(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsx)("input",{type:"text",placeholder:"ar"===d?"مهارة (مثال: Javascript, القيادة...)":"F\xe4higkeit",className:"input-field flex-1",value:e,onChange:e=>{let r=[...j];r[t]=e.target.value,v(r)}}),(0,i.jsx)("button",{onClick:()=>v(j.filter((e,r)=>r!==t)),className:"text-red-400 hover:text-red-300",children:"\xd7"})]},t))})]}),(0,i.jsxs)("section",{children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold text-primary-400",children:"ar"===d?"اللغات":"Sprachen"}),(0,i.jsxs)("button",{onClick:()=>S([...w,{language:"",level:""}]),className:"btn btn-sm btn-outline",children:["+ ","ar"===d?"إضافة":"Hinzuf\xfcgen"]})]}),w.map((e,t)=>(0,i.jsxs)("div",{className:"flex gap-4 mb-2",children:[(0,i.jsx)("input",{type:"text",placeholder:"ar"===d?"اللغة":"Sprache",className:"input-field flex-1",value:e.language,onChange:e=>{let r=[...w];r[t].language=e.target.value,S(r)}}),(0,i.jsx)("input",{type:"text",placeholder:"ar"===d?"المستوى":"Niveau",className:"input-field flex-1",value:e.level,onChange:e=>{let r=[...w];r[t].level=e.target.value,S(r)}}),(0,i.jsx)("button",{onClick:()=>S(w.filter((e,r)=>r!==t)),className:"text-red-400 hover:text-red-300",children:"\xd7"})]},t))]}),(0,i.jsx)("button",{onClick:F,className:"btn btn-primary btn-lg mt-8 w-full",children:"ar"===d?`إنشاء السيرة الذاتية (3 رصيد)`:"Lebenslauf erstellen (3 Credits)"})]})]}):"generating"===c?(0,i.jsxs)("div",{className:"glass-card flex-center",style:{minHeight:"400px",flexDirection:"column"},children:[(0,i.jsx)("div",{className:"loading-spinner mb-4"}),(0,i.jsx)("h3",{className:"text-xl font-bold",children:"ar"===d?"جاري إنشاء السيرة الذاتية...":"Lebenslauf wird erstellt..."}),(0,i.jsx)("p",{className:"text-neutral-400 mt-2 text-center max-w-md",children:"ar"===d?"يقوم الذكاء الاصطناعي الآن بترجمة بياناتك وصياغتها وتنسيقها لتناسب سوق العمل الألماني.":"Die KI \xfcbersetzt, formuliert und formatiert Ihre Daten f\xfcr den deutschen Arbeitsmarkt."})]}):"result"===c&&C?(0,i.jsxs)("div",{className:"glass-card animate-scale-in",children:[(0,i.jsx)("div",{style:{display:"flex",alignItems:"center",marginBottom:"1.5rem",justifyContent:"space-between"},children:(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("button",{onClick:()=>u("form"),style:{background:"none",border:"none",color:"var(--color-neutral-300)",cursor:"pointer",marginRight:"1rem",fontSize:"1.2rem"},children:"←"}),(0,i.jsx)("h2",{className:"text-xl font-bold text-white",children:"ar"===d?"سيرتك الذاتية جاهزة!":"Ihr Lebenslauf ist fertig!"})]})}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,i.jsxs)("div",{className:"preview-container bg-white text-black p-8 rounded shadow-lg overflow-y-auto max-h-[600px]",style:{fontFamily:"Arial, sans-serif"},children:[(0,i.jsxs)("h1",{className:"text-3xl font-bold text-gray-900 border-b-2 border-gray-900 pb-2 mb-4",children:[C.personalInfo.firstName," ",C.personalInfo.lastName]}),(0,i.jsx)("p",{className:"text-xl text-gray-600 mb-4",children:C.personalInfo.jobTitle}),(0,i.jsxs)("p",{className:"text-sm text-gray-500 mb-6",children:[C.personalInfo.email," | ",C.personalInfo.phone," | ",C.personalInfo.address]}),C.summary&&(0,i.jsxs)("div",{className:"mb-6",children:[(0,i.jsx)("h3",{className:"text-lg font-bold border-b border-gray-300 mb-2 uppercase text-gray-800",children:"Profil"}),(0,i.jsx)("p",{className:"text-gray-700 leading-relaxed",children:C.summary})]}),(0,i.jsxs)("div",{className:"mb-6",children:[(0,i.jsx)("h3",{className:"text-lg font-bold border-b border-gray-300 mb-2 uppercase text-gray-800",children:"Berufserfahrung"}),C.experience.map((e,t)=>(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("h4",{className:"font-bold text-gray-800",children:e.title}),(0,i.jsxs)("p",{className:"text-gray-600 italic text-sm",children:[e.company,", ",e.location," | ",e.startDate," - ",e.endDate]}),(0,i.jsx)("p",{className:"text-gray-700 mt-1 text-sm",children:e.description})]},t))]}),(0,i.jsxs)("div",{className:"mb-6",children:[(0,i.jsx)("h3",{className:"text-lg font-bold border-b border-gray-300 mb-2 uppercase text-gray-800",children:"Ausbildung"}),C.education.map((e,t)=>(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("h4",{className:"font-bold text-gray-800",children:e.degree}),(0,i.jsxs)("p",{className:"text-gray-600 italic text-sm",children:[e.institution,", ",e.location," | ",e.startDate," - ",e.endDate]})]},t))]}),(0,i.jsxs)("div",{className:"mb-6",children:[(0,i.jsx)("h3",{className:"text-lg font-bold border-b border-gray-300 mb-2 uppercase text-gray-800",children:"Kenntnisse"}),(0,i.jsx)("div",{className:"flex flex-wrap gap-2",children:C.skills.map((e,t)=>(0,i.jsx)("span",{className:"bg-gray-200 px-2 py-1 rounded text-sm text-gray-700",children:e},t))})]})]}),(0,i.jsxs)("div",{className:"actions-container flex flex-col gap-4",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold text-white mb-2",children:"ar"===d?"خيارات التنزيل":"Download-Optionen"}),(0,i.jsx)(I.XP,{document:(0,i.jsx)(T,{data:C}),fileName:`${C.personalInfo.lastName}_Lebenslauf.pdf`,children:({loading:e})=>(0,i.jsx)("button",{className:"btn btn-primary w-full py-4 flex items-center justify-center gap-2",disabled:e,children:e?"Generating PDF...":(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"ar"===d?"تحميل PDF (نسخة ATS)":"PDF herunterladen (ATS)"]})})}),(0,i.jsxs)("button",{className:"btn btn-secondary w-full py-4 flex items-center justify-center gap-2",onClick:()=>{let e=new Blob([JSON.stringify(C,null,2)],{type:"text/plain"}),t=URL.createObjectURL(e),r=document.createElement("a");r.href=t,r.download="cv_data.json",r.click()},children:[(0,i.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"ar"===d?"تحميل بيانات JSON":"JSON Daten herunterladen"]}),(0,i.jsx)("div",{className:"mt-8 p-4 bg-blue-500/10 border border-blue-500/30 rounded-lg",children:(0,i.jsx)("p",{className:"text-sm text-blue-200",children:"ar"===d?"ملاحظة: هذا التصميم بسيط خصيصاً ليتم قراءته بسهولة بواسطة أنظمة التوظيف الآلية (ATS). المحتوى هو الأهم!":"Hinweis: Dieses einfache Design ist f\xfcr ATS-Systeme optimiert. Der Inhalt z\xe4hlt!"})})]})]})]}):null}async function _(e){let t=await r.e(84).then(r.bind(r,66898));t.GlobalWorkerOptions.workerSrc=`//unpkg.com/pdfjs-dist@${t.version}/build/pdf.worker.min.mjs`;let i=await e.arrayBuffer(),a=await t.getDocument({data:i}).promise,n=await a.getPage(1),s=n.getViewport({scale:1.5}),l=document.createElement("canvas"),o=l.getContext("2d");if(!o)throw Error("Canvas context not available");return l.height=s.height,l.width=s.width,await n.render({canvasContext:o,viewport:s}).promise,l.toDataURL("image/png")}async function P(e){if("application/pdf"===e.type){let t=await _(e);return{file:e,base64:t}}{let t=f(e);if(!t.valid)throw Error(t.error);return new Promise((t,r)=>{let i=new FileReader;i.onload=()=>t({file:e,base64:i.result}),i.onerror=()=>r(Error("Failed to read file")),i.readAsDataURL(e)})}}function A({onBack:e}){let{locale:t}=(0,s.nm)(),[r,n]=(0,a.useState)(null),[l,o]=(0,a.useState)(null),[d,c]=(0,a.useState)(!1),[u,m]=(0,a.useState)(!1),h=async e=>{if(e.target.files&&e.target.files.length>0){c(!0);try{let t=e.target.files[0],{formattedFile:r,base64:i}=await P(t).then(e=>({formattedFile:e.file,base64:e.base64}));n(r||t),o(i)}catch(e){console.error(e),alert("Error loading file")}finally{c(!1)}}},g=async e=>{if(l){c(!0);try{let t=new Image;t.src=l,await new Promise(e=>{t.onload=e});let r=t.width>t.height?"landscape":"portrait",i=new j.jsPDF({orientation:r,unit:"pt",format:[t.width,t.height]});i.addImage(l,"PNG",0,0,t.width,t.height),e.forEach(e=>{let r=e.x/100*t.width,a=e.y/100*t.height;if("signature"===e.type&&e.imageUrl){let n=e.width/100*t.width,s=e.height/100*t.height;i.addImage(e.imageUrl,"PNG",r,a,n,s)}else{i.setFontSize(e.fontSize);let n=e.text||"";if(i.setTextColor(0,0,0),e.width){let s=e.width/100*t.width-12;if(s>0){let t=i.splitTextToSize(n,s);i.text(t,r+6,a+e.fontSize+4)}else i.text(n,r+6,a+e.fontSize+4)}else i.text(n,r+6,a+e.fontSize+4)}}),i.save("edited-document.pdf"),m(!0)}catch(e){console.error("PDF Generation failed",e),alert("Failed to generate PDF")}finally{c(!1)}}};return d&&!l?(0,i.jsxs)("div",{className:"flex-center",style:{minHeight:"100vh",flexDirection:"column",gap:"1rem"},children:[(0,i.jsx)("div",{className:"loading-spinner"}),(0,i.jsx)("p",{style:{color:"white"},children:"ar"===t?"جاري المعالجة...":"Wird verarbeitet..."})]}):u?(0,i.jsx)("div",{className:"animate-fade-in",style:{padding:"2rem"},children:(0,i.jsxs)("div",{className:"glass-card",style:{padding:"3rem",textAlign:"center",maxWidth:"500px",margin:"0 auto",display:"flex",flexDirection:"column",alignItems:"center",gap:"1.5rem"},children:[(0,i.jsx)("div",{style:{width:"64px",height:"64px",background:"rgba(34, 197, 94, 0.2)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",color:"#22c55e",fontSize:"32px"},children:"✓"}),(0,i.jsx)("h2",{style:{color:"white",margin:0},children:"ar"===t?"تمت العملية بنجاح":"Vorgang erfolgreich"}),(0,i.jsx)("p",{style:{color:"var(--color-neutral-300)",margin:0},children:"ar"===t?"تم تحميل ملف PDF الخاص بك بنجاح.":"Ihr PDF wurde erfolgreich heruntergeladen."}),(0,i.jsxs)("div",{style:{display:"flex",gap:"1rem",marginTop:"1rem",width:"100%"},children:[(0,i.jsx)("button",{onClick:()=>{n(null),o(null),m(!1)},className:"btn btn-primary",style:{flex:1},children:"ar"===t?"مستند جديد":"Neues Dokument"}),(0,i.jsx)("button",{onClick:e,className:"btn btn-secondary",style:{flex:1},children:"ar"===t?"القائمة الرئيسية":"Hauptmen\xfc"})]})]})}):l?(0,i.jsxs)("div",{className:"animate-fade-in",children:[(0,i.jsx)("div",{style:{padding:"1rem",borderBottom:"1px solid rgba(255,255,255,0.1)",display:"flex",alignItems:"center",justifyContent:"space-between"},children:(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[(0,i.jsxs)("button",{onClick:e,className:"btn btn-secondary",style:{padding:"0.4rem 0.8rem"},children:["← ","ar"===t?"الرجوع":"Zur\xfcck"]}),(0,i.jsx)("h2",{style:{color:"white",margin:0},children:"ar"===t?"تحرير المستند":"Dokument bearbeiten"})]})}),(0,i.jsx)(C,{imageBase64:l,fields:[],onComplete:g,locale:t})]}):(0,i.jsxs)("div",{className:"animate-fade-in",children:[(0,i.jsxs)("div",{style:{marginBottom:"1rem",display:"flex",alignItems:"center"},children:[(0,i.jsxs)("button",{onClick:e,className:"btn btn-secondary",style:{marginRight:"1rem",padding:"0.4rem 0.8rem",fontSize:"0.9rem"},children:["← ","ar"===t?"الرجوع":"Zur\xfcck"]}),(0,i.jsx)("h2",{style:{color:"white",margin:0},children:"ar"===t?"محرر PDF & التوقيع":"PDF Editor & Unterschrift"})]}),(0,i.jsx)("div",{className:"glass-card",style:{padding:"3rem",textAlign:"center"},children:(0,i.jsxs)("div",{className:"upload-zone",style:{border:"2px dashed var(--color-neutral-600)",borderRadius:"var(--radius-lg)",padding:"3rem",cursor:"pointer",transition:"all 0.2s ease",background:"rgba(255,255,255,0.02)"},children:[(0,i.jsx)("input",{type:"file",accept:"application/pdf,image/*",onChange:h,style:{display:"none"},id:"pdf-upload"}),(0,i.jsxs)("label",{htmlFor:"pdf-upload",style:{cursor:"pointer",display:"block",width:"100%",height:"100%"},children:[(0,i.jsx)("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:"✍️"}),(0,i.jsx)("h3",{style:{color:"var(--color-neutral-200)",marginBottom:"0.5rem"},children:"ar"===t?"اضغط لرفع ملف PDF أو صورة":"PDF oder Bild hochladen"}),(0,i.jsx)("p",{style:{color:"var(--color-neutral-400)"},children:"PDF, JPG, PNG (Max 10MB)"})]})]})})]})}var E=r(34235);function L({onBack:e}){let{locale:t}=(0,s.nm)(),[r,n]=(0,a.useState)(""),[l,o]=(0,a.useState)(),[d,c]=(0,a.useState)(),[u,m]=(0,a.useState)(0),[h,g]=(0,a.useState)(!1),p=(0,a.useRef)(null);(0,a.useRef)(null),(0,a.useRef)("");let x=e=>{if(!r)return;g(!0);let t=new Image;t.src=r,t.onload=()=>{let r=document.createElement("canvas");90===Math.abs(e)?(r.width=t.height,r.height=t.width):(r.width=t.width,r.height=t.height);let i=r.getContext("2d");i&&(i.translate(r.width/2,r.height/2),i.rotate(e*Math.PI/180),i.drawImage(t,-t.width/2,-t.height/2),n(r.toDataURL()),o(void 0),g(!1))}},b=async()=>{if(r&&p.current){g(!0);try{let e=document.createElement("canvas"),t=p.current,r=e.getContext("2d");if(!r)throw Error("No 2d context");let i=t.naturalWidth/t.width,a=t.naturalHeight/t.height,n=d??{x:0,y:0,width:t.width,height:t.height,unit:"px"},s=n.width*i,l=n.height*a,o=n.x*i,c=n.y*a;e.width=s,e.height=l,r.drawImage(t,o,c,s,l,0,0,s,l);let u=e.toDataURL("image/jpeg",.95),m=s>l?"landscape":"portrait",h=new j.jsPDF({orientation:m,unit:"pt",format:[.75*s,.75*l]}),g=h.internal.pageSize.getWidth(),x=h.internal.pageSize.getHeight();h.addImage(u,"JPEG",0,0,g,x),h.save("document.pdf")}catch(e){console.error(e)}finally{g(!1)}}};return(0,i.jsxs)("div",{className:"animate-fade-in",children:[(0,i.jsxs)("div",{style:{marginBottom:"1rem",display:"flex",alignItems:"center"},children:[(0,i.jsxs)("button",{onClick:e,className:"btn btn-secondary",style:{marginRight:"1rem",padding:"0.4rem 0.8rem",fontSize:"0.9rem"},children:["← ","ar"===t?"الرجوع":"Zur\xfcck"]}),(0,i.jsx)("h2",{style:{color:"white",margin:0},children:"ar"===t?"تحويل صورة إلى PDF":"Bild zu PDF"})]}),(0,i.jsx)("div",{className:"glass-card",style:{padding:"2rem"},children:r?(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[(0,i.jsxs)("div",{style:{display:"flex",gap:"1rem",justifyContent:"center"},children:[(0,i.jsxs)("button",{className:"btn btn-secondary",onClick:()=>x(-90),disabled:h,children:["↺ ","ar"===t?"تدوير يسار":"Links drehen"]}),(0,i.jsxs)("button",{className:"btn btn-secondary",onClick:()=>x(90),disabled:h,children:["↻ ","ar"===t?"تدوير يمين":"Rechts drehen"]}),(0,i.jsxs)("button",{className:"btn btn-secondary",onClick:()=>n(""),children:["✕ ","ar"===t?"إلغاء":"Entfernen"]})]}),(0,i.jsx)("div",{style:{maxWidth:"100%",overflow:"auto",background:"#000",borderRadius:"8px",display:"flex",justifyContent:"center"},children:(0,i.jsx)(E.Ay,{crop:l,onChange:(e,t)=>o(t),onComplete:e=>c(e),style:{maxHeight:"70vh"},children:(0,i.jsx)("img",{ref:p,alt:"Crop me",src:r,onLoad:e=>{var t;let{width:r,height:i}=e.currentTarget;o((t=r/i,(0,E.ge)((0,E.dS)({unit:"%",width:90},t,r,i),r,i)))},style:{display:"block",maxHeight:"70vh",maxWidth:"100%"}})})}),(0,i.jsx)("button",{className:"btn btn-primary btn-lg",onClick:b,disabled:h,style:{width:"100%"},children:h?(0,i.jsx)("span",{className:"loading-spinner"}):"ar"===t?"\uD83D\uDCC4 إنشاء PDF":"\uD83D\uDCC4 PDF generieren"})]}):(0,i.jsxs)("div",{className:"upload-zone",style:{border:"2px dashed var(--color-neutral-600)",borderRadius:"var(--radius-lg)",padding:"3rem",textAlign:"center",cursor:"pointer",transition:"all 0.2s ease",background:"rgba(255,255,255,0.02)"},children:[(0,i.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{if(e.target.files&&e.target.files.length>0){o(void 0);let t=e.target.files[0],r=f(t);if(!r.valid)return void alert(r.error);let i=new FileReader;i.addEventListener("load",()=>n(i.result?.toString()||"")),i.readAsDataURL(t)}},style:{display:"none"},id:"pdf-img-upload"}),(0,i.jsxs)("label",{htmlFor:"pdf-img-upload",style:{cursor:"pointer",display:"block",width:"100%",height:"100%"},children:[(0,i.jsx)("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:"\uD83D\uDDBC️"}),(0,i.jsx)("h3",{style:{color:"var(--color-neutral-200)",marginBottom:"0.5rem"},children:"ar"===t?"اضغط لرفع صورة":"Klicken zum Hochladen"}),(0,i.jsx)("p",{style:{color:"var(--color-neutral-400)"},children:"JPG, PNG (Max 10MB)"})]})]})})]})}function R(){let e=(0,n.useSearchParams)(),{locale:t,setLocale:r,credits:l}=(0,s.nm)(),[c,m]=(0,a.useState)(null),[g,p]=(0,a.useState)(null),[x,f]=(0,a.useState)(!0),[b,y]=(0,a.useState)(!1),[j,v]=(0,a.useState)(!1),[w,S]=(0,a.useState)(l),[N,k]=(0,a.useState)(null),[C,I]=(0,a.useState)(0);(0,a.useEffect)(()=>{document.documentElement.dir="ar"===t?"rtl":"ltr",document.documentElement.lang=t},[t]);let[D,T]=(0,a.useState)(null);(0,a.useEffect)(()=>{let t=e.get("payment"),r=e.get("credits"),i=e.get("verified"),a=e.get("error");"success"===t&&r?(k("success"),I(parseInt(r,10)),_(),setTimeout(()=>{window.history.replaceState({},"","/"),k(null)},5e3)):"cancelled"===t&&(k("cancelled"),setTimeout(()=>{window.history.replaceState({},"","/"),k(null)},5e3)),"true"===i?(T("success"),_(),setTimeout(()=>{window.history.replaceState({},"","/"),T(null)},5e3)):("invalid_token"===a||"missing_token"===a)&&(T("error"),setTimeout(()=>{window.history.replaceState({},"","/"),T(null)},5e3))},[e]);let _=async()=>{try{if(!sessionStorage.getItem("formbridge_tab_session")){await fetch("/api/auth/logout",{method:"POST"}),p(null),f(!1);return}let e=await fetch("/api/auth/me"),t=await e.json();t.success&&t.user?(p(t.user),S(t.user.credits)):sessionStorage.removeItem("formbridge_tab_session")}catch{sessionStorage.removeItem("formbridge_tab_session")}finally{f(!1)}};(0,a.useEffect)(()=>{_()},[]);let P=async()=>{try{await fetch("/api/auth/logout",{method:"POST"}),sessionStorage.removeItem("formbridge_tab_session"),p(null),S(l),m(null)}catch{}};return x?(0,i.jsx)("div",{className:"flex-center",style:{minHeight:"100vh"},children:(0,i.jsx)("div",{className:"loading-spinner"})}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(d,{locale:t,onLocaleChange:r,credits:w,user:g,onLoginClick:()=>y(!0),onLogout:P,onBuyCredits:()=>v(!0)}),(0,i.jsxs)("main",{className:"container",children:[(0,i.jsxs)("section",{className:"hero",children:[(0,i.jsx)("h1",{className:"hero__title",children:o(t,"hero.title")}),(0,i.jsx)("p",{className:"hero__subtitle",children:o(t,"hero.subtitle")})]}),"success"===N&&(0,i.jsxs)("div",{className:"payment-status payment-status--success animate-fade-in",children:[(0,i.jsx)("svg",{className:"payment-status__icon",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),o(t,"credits.paymentSuccess")," (+",C," ",o(t,"credits.creditsLabel"),")"]}),"success"===D&&(0,i.jsxs)("div",{className:"payment-status payment-status--success animate-fade-in",style:{backgroundColor:"#dcfce7",color:"#166534",borderColor:"#bbf7d0"},children:[(0,i.jsx)("svg",{className:"payment-status__icon",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"ar"===t?"تم التحقق من بريدك الإلكتروني بنجاح!":"Email verified successfully!"]}),"error"===D&&(0,i.jsxs)("div",{className:"payment-status animate-fade-in",style:{backgroundColor:"#fee2e2",color:"#991b1b",borderColor:"#fecaca"},children:[(0,i.jsx)("svg",{className:"payment-status__icon",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"ar"===t?"فشل التحقق من البريد الإلكتروني. الرابط غير صالح.":"Email verification failed. Invalid token."]}),g?(0,i.jsx)("div",{className:"main-content",children:c?(0,i.jsxs)("div",{className:"feature-container animate-slide-up",children:["form"===c&&(0,i.jsx)(z,{user:g,userCredits:w,setUserCredits:S,onAuthRequired:()=>y(!0),onBuyCredits:()=>v(!0),onBack:()=>m(null)}),"explain"===c&&(0,i.jsx)(F,{onBack:()=>m(null)}),"cv"===c&&(0,i.jsx)(B,{onBack:()=>m(null),user:g,userCredits:w,setUserCredits:S,onAuthRequired:()=>y(!0),onBuyCredits:()=>v(!0)}),"pdf-edit"===c&&(0,i.jsx)(A,{onBack:()=>m(null)}),"image-pdf"===c&&(0,i.jsx)(L,{onBack:()=>m(null)})]}):(0,i.jsxs)("div",{className:"feature-list animate-fade-in",style:{display:"flex",flexDirection:"column",gap:"1rem",marginTop:"3rem",maxWidth:"800px",marginLeft:"auto",marginRight:"auto"},children:[(0,i.jsxs)("div",{className:"feature-card glass-card hover-lift",onClick:()=>m("form"),style:{cursor:"pointer",padding:"1.5rem",transition:"all 0.3s ease",display:"flex",alignItems:"center",textAlign:"ar"===t?"right":"left",position:"relative"},children:[(0,i.jsx)("div",{className:"feature-icon",style:{background:"var(--color-primary-600)",width:"56px",height:"56px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,["ar"===t?"marginLeft":"marginRight"]:"1.5rem",fontSize:"1.75rem"},children:"\uD83D\uDCDD"}),(0,i.jsxs)("div",{style:{flex:1},children:[(0,i.jsx)("h3",{style:{fontSize:"1.25rem",marginBottom:"0.25rem",color:"white"},children:"ar"===t?"تعبئة النماذج":"Formular ausf\xfcllen"}),(0,i.jsx)("p",{style:{color:"var(--color-neutral-400)",margin:0,fontSize:"0.95rem"},children:"ar"===t?"املأ الاستمارات الحكومية الألمانية وعقود العمل بسهولة":"F\xfcllen Sie deutsche Beh\xf6rdenformulare und Vertr\xe4ge einfach aus"})]})]}),(0,i.jsxs)("div",{className:"feature-card glass-card hover-lift",onClick:()=>m("explain"),style:{cursor:"pointer",padding:"1.5rem",transition:"all 0.3s ease",display:"flex",alignItems:"center",textAlign:"ar"===t?"right":"left",position:"relative"},children:[(0,i.jsx)("div",{className:"feature-icon",style:{background:"var(--color-accent-600)",width:"56px",height:"56px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,["ar"===t?"marginLeft":"marginRight"]:"1.5rem",fontSize:"1.75rem"},children:"\uD83D\uDCA1"}),(0,i.jsxs)("div",{style:{flex:1},children:[(0,i.jsx)("h3",{style:{fontSize:"1.25rem",marginBottom:"0.25rem",color:"white"},children:"ar"===t?"شرح المستندات":"Dokumentenerkl\xe4rung"}),(0,i.jsx)("p",{style:{color:"var(--color-neutral-400)",margin:0,fontSize:"0.95rem"},children:"ar"===t?"شرح مبسط للمستندات المعقدة باللهجة السورية":"Einfache Erkl\xe4rung komplexer Dokumente im syrischen Dialekt"})]}),(0,i.jsx)("span",{className:"badge badge-new",style:{background:"var(--color-accent-500)",color:"white",padding:"0.2rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",position:"absolute",top:"1rem",["ar"===t?"left":"right"]:"1rem"},children:"NEW"})]}),(0,i.jsxs)("div",{className:"feature-card glass-card hover-lift",onClick:()=>m("cv"),style:{cursor:"pointer",padding:"1.5rem",transition:"all 0.3s ease",display:"flex",alignItems:"center",textAlign:"ar"===t?"right":"left",position:"relative"},children:[(0,i.jsx)("div",{className:"feature-icon",style:{background:"var(--color-success-600)",width:"56px",height:"56px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,["ar"===t?"marginLeft":"marginRight"]:"1.5rem",fontSize:"1.75rem"},children:"\uD83D\uDC54"}),(0,i.jsxs)("div",{style:{flex:1},children:[(0,i.jsx)("h3",{style:{fontSize:"1.25rem",marginBottom:"0.25rem",color:"white"},children:"ar"===t?"إنشاء سيرة ذاتية":"Lebenslauf erstellen"}),(0,i.jsx)("p",{style:{color:"var(--color-neutral-400)",margin:0,fontSize:"0.95rem"},children:"ar"===t?"أنشئ سيرة ذاتية بتصميم احترافي أو متوافق مع نظام ATS":"Erstellen Sie professionelle oder ATS-optimierte Lebensl\xe4ufe"})]}),(0,i.jsx)("span",{className:"badge badge-new",style:{background:"var(--color-accent-500)",color:"white",padding:"0.2rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",position:"absolute",top:"1rem",["ar"===t?"left":"right"]:"1rem"},children:"NEW"})]}),(0,i.jsxs)("div",{className:"feature-card glass-card hover-lift",onClick:()=>m("pdf-edit"),style:{cursor:"pointer",padding:"1.5rem",transition:"all 0.3s ease",display:"flex",alignItems:"center",textAlign:"ar"===t?"right":"left",position:"relative"},children:[(0,i.jsx)("div",{className:"feature-icon",style:{background:"var(--color-secondary-600)",width:"56px",height:"56px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,["ar"===t?"marginLeft":"marginRight"]:"1.5rem",fontSize:"1.75rem"},children:"✍️"}),(0,i.jsxs)("div",{style:{flex:1},children:[(0,i.jsx)("h3",{style:{fontSize:"1.25rem",marginBottom:"0.25rem",color:"white"},children:"ar"===t?"تعديل وتوقيع PDF":"PDF bearbeiten & unterschreiben"}),(0,i.jsx)("p",{style:{color:"var(--color-neutral-400)",margin:0,fontSize:"0.95rem"},children:"ar"===t?"ارفع ملف PDF، أضف نصوصاً وتوقيعك الشخصي":"PDF hochladen, Text und Unterschrift hinzuf\xfcgen"})]})]}),(0,i.jsxs)("div",{className:"feature-card glass-card hover-lift",onClick:()=>m("image-pdf"),style:{cursor:"pointer",padding:"1.5rem",transition:"all 0.3s ease",display:"flex",alignItems:"center",textAlign:"ar"===t?"right":"left",position:"relative"},children:[(0,i.jsx)("div",{className:"feature-icon",style:{background:"var(--color-warning-600)",width:"56px",height:"56px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,["ar"===t?"marginLeft":"marginRight"]:"1.5rem",fontSize:"1.75rem"},children:"\uD83D\uDDBC️"}),(0,i.jsxs)("div",{style:{flex:1},children:[(0,i.jsx)("h3",{style:{fontSize:"1.25rem",marginBottom:"0.25rem",color:"white"},children:"ar"===t?"صورة إلى PDF":"Bild zu PDF"}),(0,i.jsx)("p",{style:{color:"var(--color-neutral-400)",margin:0,fontSize:"0.95rem"},children:"ar"===t?"قص وتدوير الصور وتحويلها إلى مستند PDF":"Bilder zuschneiden, drehen und in PDF umwandeln"})]})]})]})}):(0,i.jsxs)("div",{className:"auth-required glass-card animate-slide-up",style:{marginBottom:"5rem"},children:[(0,i.jsx)("div",{className:"auth-required__icon",children:(0,i.jsx)("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:(0,i.jsx)("path",{d:"M12 15v2m0 0v2m0-2h2m-2 0H10m7-7V7a5 5 0 00-10 0v4m-2 0h14a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2z"})})}),(0,i.jsx)("h2",{children:o(t,"auth.requiredTitle")}),(0,i.jsx)("p",{children:o(t,"auth.requiredSubtitle")}),(0,i.jsx)("div",{className:"auth-required__actions",children:(0,i.jsx)("button",{className:"btn btn-primary btn-lg",onClick:()=>y(!0),children:o(t,"auth.login")})})]})]}),(0,i.jsx)(u,{isOpen:b,onClose:()=>y(!1),onSuccess:e=>{sessionStorage.setItem("formbridge_tab_session","active"),p(e),S(e.credits),y(!1)},locale:t}),(0,i.jsx)(h,{isOpen:j,onClose:()=>v(!1),locale:t,isLoggedIn:!!g,onLoginRequired:()=>{v(!1),y(!0)}})]})}function M(){return(0,i.jsx)(a.Suspense,{fallback:(0,i.jsx)("div",{className:"flex-center",style:{minHeight:"100vh"},children:(0,i.jsx)("div",{className:"loading-spinner"})}),children:(0,i.jsx)(R,{})})}r(48858)},26473:(e,t,r)=>{"use strict";r.d(t,{AppProvider:()=>l,nm:()=>o});var i=r(95155),a=r(12115);let n="formbridge_credits",s=(0,a.createContext)(void 0);function l({children:e,initialLocale:t="ar"}){let[r,l]=(0,a.useState)(t),[o,d]=(0,a.useState)(()=>{{let e=localStorage.getItem(n);return e?parseInt(e,10):10}}),[c,u]=(0,a.useState)("upload"),m=(0,a.useCallback)(e=>{l(e),"u">typeof document&&(document.documentElement.dir="ar"===e?"rtl":"ltr",document.documentElement.lang=e)},[]),h=(0,a.useCallback)(e=>{if(o<e)return!1;let t=o-e;return d(t),localStorage.setItem(n,t.toString()),!0},[o]);return(0,i.jsx)(s.Provider,{value:{locale:r,setLocale:m,credits:o,deductCredits:h,step:c,setStep:u},children:e})}function o(){let e=(0,a.useContext)(s);if(void 0===e)throw Error("useApp must be used within an AppProvider");return e}},27004:(e,t,r)=>{Promise.resolve().then(r.bind(r,25435))},50477:()=>{}},e=>{e.O(0,[723,247,293,278,788,746,792,930,534,441,794,358],()=>e(e.s=27004)),_N_E=e.O()}]);